THREE.BadTVShader={uniforms:{tDiffuse:{type:"t",value:null},time:{type:"f",value:0},distortion:{type:"f",value:3},distortion2:{type:"f",value:5},speed:{type:"f",value:.2},rollSpeed:{type:"f",value:.1},randomSeed:{type:"f",value:150*Math.random()}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D tDiffuse;","uniform float time;","uniform float distortion;","uniform float distortion2;","uniform float speed;","uniform float rollSpeed;","uniform float randomSeed;","varying vec2 vUv;","vec3 mod289(vec3 x) {","  return x - floor(x * (1.0 / 289.0)) * 289.0;","}","vec2 mod289(vec2 x) {","  return x - floor(x * (1.0 / 289.0)) * 289.0;","}","vec3 permute(vec3 x) {","  return mod289(((x*34.0)+1.0)*x);","}","float snoise(vec2 v)","  {","  const vec4 C = vec4(0.211324865405187,  // (3.0-sqrt(3.0))/6.0","                      0.366025403784439,  // 0.5*(sqrt(3.0)-1.0)","                     -0.577350269189626,  // -1.0 + 2.0 * C.x","                      0.024390243902439); // 1.0 / 41.0","  vec2 i  = floor(v + dot(v, C.yy) );","  vec2 x0 = v -   i + dot(i, C.xx);","  vec2 i1;","  i1 = (x0.x > x0.y) ? vec2(1.0, 0.0) : vec2(0.0, 1.0);","  vec4 x12 = x0.xyxy + C.xxzz;"," x12.xy -= i1;","  i = mod289(i); // Avoid truncation effects in permutation","  vec3 p = permute( permute( i.y + vec3(0.0, i1.y, 1.0 ))","\t\t+ i.x + vec3(0.0, i1.x, 1.0 ));","  vec3 m = max(0.5 - vec3(dot(x0,x0), dot(x12.xy,x12.xy), dot(x12.zw,x12.zw)), 0.0);","  m = m*m ;","  m = m*m ;","  vec3 x = 2.0 * fract(p * C.www) - 1.0;","  vec3 h = abs(x) - 0.5;","  vec3 ox = floor(x + 0.5);","  vec3 a0 = x - ox;","  m *= 1.79284291400159 - 0.85373472095314 * ( a0*a0 + h*h );","  vec3 g;","  g.x  = a0.x  * x0.x  + h.x  * x0.y;","  g.yz = a0.yz * x12.xz + h.yz * x12.yw;","  return 130.0 * dot(m, g);","}","void main() {","vec2 p = vUv;","float ty = time*speed;","float yt = p.y - ty + randomSeed;","float offset = snoise(vec2(yt*3.0,0.0))*0.2;","offset = pow( offset*distortion,3.0)/distortion;","offset += snoise(vec2(yt*50.0,0.0))*distortion2*0.001;","gl_FragColor = texture2D(tDiffuse,  vec2(fract(p.x + offset),fract(p.y-time*rollSpeed) ));","}"].join("\n")},THREE.ColladaLoader=function(){function B(a,b,c,d){var f=0;if(document.implementation&&document.implementation.createDocument){var g=new XMLHttpRequest;g.onreadystatechange=function(){4===g.readyState?0===g.status||200===g.status?g.response?(e=b,C(g.response,void 0,a)):d?d({type:"error",url:a}):console.error("ColladaLoader: Empty or non-existing file ("+a+")"):d?d({type:"error",url:a}):console.error("ColladaLoader: Couldn't load \""+a+'" ('+g.status+")"):3===g.readyState&&c&&(0===f&&(f=g.getResponseHeader("Content-Length")),c({total:f,loaded:g.responseText.length}))},g.open("GET",a,!0),g.send(null)}else alert("Don't know how to parse XML!")}function C(f,v,w){if(a=(new DOMParser).parseFromString(f,"text/xml"),v=v||e,void 0!==w){var x=w.split("/");x.pop(),s=(x.length<1?".":x.join("/"))+"/"}E(),bb(),g=F("library_images image",da,"image"),k=F("library_materials material",xa,"material"),l=F("library_effects effect",Ca,"effect"),j=F("library_geometries geometry",na,"geometry"),m=F("library_cameras camera",Ia,"camera"),n=F("library_lights light",Ka,"light"),i=F("library_controllers controller",ea,"controller"),h=F("library_animations animation",Ea,"animation"),q=F("library_visual_scenes visual_scene",ha,"visual_scene"),r=F("library_kinematics_models kinematics_model",Ma,"kinematics_model"),t=[],u=[],c=G(),b=new THREE.Group;for(var z=0;z<c.nodes.length;z++)b.add(T(c.nodes[z]));b.scale.multiplyScalar(y),I(),d=H(),S();var A={scene:b,morphs:t,skins:u,animations:o,kinematics:p,dae:{images:g,materials:k,cameras:m,lights:n,effects:l,geometries:j,controllers:i,animations:h,visualScenes:q,visualScene:c,scene:c,kinematicsModels:r,kinematicsModel:d}};return v&&v(A),A}function D(a){w=a}function E(){var b=a.querySelectorAll("asset"),c=b[0];if(c&&c.childNodes)for(var d=0;d<c.childNodes.length;d++){var e=c.childNodes[d];switch(e.nodeName){case"unit":var f=e.getAttribute("meter");f&&(y=parseFloat(f));break;case"up_axis":z=e.textContent.charAt(0)}}}function F(b,c,d){for(var e=a.querySelectorAll(b),f={},g=0,h=e.length,i=0;i<h;i++){var j=e[i],k=(new c).parse(j);k.id&&0!==k.id.length||(k.id=d+g++),f[k.id]=k}return f}function G(){var b=a.querySelectorAll("scene instance_visual_scene")[0];if(b){var c=b.getAttribute("url").replace(/^#/,"");return q[c.length>0?c:"visual_scene0"]}return null}function H(){var b=a.querySelectorAll("instance_kinematics_model")[0];if(b){var c=b.getAttribute("url").replace(/^#/,"");return r[c.length>0?c:"kinematics_model0"]}return null}function I(){o=[],J(b)}function J(a){var b=c.getChildById(a.colladaId,!0),d=null;if(b&&b.keys){d={fps:60,hierarchy:[{node:b,keys:b.keys,sids:b.sids}],node:a,name:"animation_"+a.name,length:0},o.push(d);for(var e=0,f=b.keys.length;e<f;e++)d.length=Math.max(d.length,b.keys[e].time)}else d={hierarchy:[{keys:[],sids:[]}]};for(var e=0,f=a.children.length;e<f;e++)for(var g=J(a.children[e]),h=0,i=g.hierarchy.length;h<i;h++)d.hierarchy.push({keys:[],sids:[]});return d}function K(){var d,a=1e6,b=-a,c=0;for(var e in h){var f=h[e];d=d||f.id;for(var g=0;g<f.sampler.length;g++){var i=f.sampler[g];i.create(),a=Math.min(a,i.startTime),b=Math.max(b,i.endTime),c=Math.max(c,i.input.length)}}return{start:a,end:b,frames:c,ID:d}}function L(a,b){var c=b instanceof ka?i[b.url]:b;if(!c||!c.morph)return void console.log("could not find morph controller!");for(var d=c.morph,e=0;e<d.targets.length;e++){var f=d.targets[e],g=j[f];if(g.mesh&&g.mesh.primitives&&g.mesh.primitives.length){var h=g.mesh.primitives[0].geometry;h.vertices.length===a.vertices.length&&a.morphTargets.push({name:"target_1",vertices:h.vertices})}}a.morphTargets.push({name:"target_Z",vertices:a.vertices})}function N(a,b,c,d){if(a.world=a.world||new THREE.Matrix4,a.localworld=a.localworld||new THREE.Matrix4,a.world.copy(a.matrix),a.localworld.copy(a.matrix),a.channels&&a.channels.length){var e=a.channels[0],f=e.sampler.output[c];f instanceof THREE.Matrix4&&(a.world.copy(f),a.localworld.copy(f),0===c&&a.matrix.copy(f))}d&&a.world.multiplyMatrices(d,a.world),b.push(a);for(var g=0;g<a.nodes.length;g++)N(a.nodes[g],b,c,a.world)}function O(a,b){for(var c=0;c<a.length;c++){var d=a[c],e=-1;if("JOINT"==d.type){for(var f=0;f<b.joints.length;f++)if(d.sid===b.joints[f]){e=f;break}if(e>=0){var g=b.invBindMatrices[e];d.invBindMatrix=g,d.skinningMatrix=new THREE.Matrix4,d.skinningMatrix.multiplyMatrices(d.world,g),d.animatrix=new THREE.Matrix4,d.animatrix.copy(d.localworld),d.weights=[];for(var f=0;f<b.weights.length;f++)for(var h=0;h<b.weights[f].length;h++){var i=b.weights[f][h];i.joint===e&&d.weights.push(i)}}else console.warn("ColladaLoader: Could not find joint '"+d.sid+"'."),d.skinningMatrix=new THREE.Matrix4,d.weights=[]}}}function P(a){var b=[],c=function(a,b,d){var e={};e.name=b.sid,e.parent=a,e.matrix=b.matrix;var f=[new THREE.Vector3,new THREE.Quaternion,new THREE.Vector3];e.matrix.decompose(f[0],f[1],f[2]),e.pos=[f[0].x,f[0].y,f[0].z],e.scl=[f[2].x,f[2].y,f[2].z],e.rotq=[f[1].x,f[1].y,f[1].z,f[1].w],d.push(e);for(var g in b.nodes)c(b.sid,b.nodes[g],d)};return c(-1,a,b),b}function Q(a,b,c){var d=[];N(b,d,-1),O(d,c.skin);for(var e=new THREE.Vector3,f=[],g=0;g<a.vertices.length;g++)f.push(new THREE.Vector3);for(g=0;g<d.length;g++)if("JOINT"==d[g].type)for(var h=0;h<d[g].weights.length;h++){var i=d[g].weights[h],j=i.index,k=i.weight,l=a.vertices[j],m=f[j];e.x=l.x,e.y=l.y,e.z=l.z,e.applyMatrix4(d[g].skinningMatrix),m.x+=e.x*k,m.y+=e.y*k,m.z+=e.z*k}for(var g=0;g<a.vertices.length;g++)a.vertices[g]=f[g]}function R(a,b,d){var e=i[b.url];if(d=void 0!==d?d:40,!e||!e.skin)return void console.log("ColladaLoader: Could not find skin controller.");if(!b.skeleton||!b.skeleton.length)return void console.log("ColladaLoader: Could not find the skeleton for the skin. ");for(var f=K(),g=c.getChildById(b.skeleton[0],!0)||c.getChildBySid(b.skeleton[0],!0),h=P(g),j=e.skin.joints,k=[],l=0;l<j.length;l++)for(var m=0;m<h.length;m++)h[m].name===j[l]&&(k[l]=h[m]);for(var l=0;l<k.length;l++)for(var m=0;m<k.length;m++)k[l].parent===k[m].name&&(k[l].parent=m);var l,m,p;new THREE.Vector3;for(l=0;l<a.vertices.length;l++)a.vertices[l].applyMatrix4(e.skin.bindShapeMatrix);for(var t=[],u=[],v=e.skin.weights,l=0;l<v.length;l++){var w=new THREE.Vector4(v[l][0]?v[l][0].joint:0,v[l][1]?v[l][1].joint:0,v[l][2]?v[l][2].joint:0,v[l][3]?v[l][3].joint:0),p=new THREE.Vector4(v[l][0]?v[l][0].weight:0,v[l][1]?v[l][1].weight:0,v[l][2]?v[l][2].weight:0,v[l][3]?v[l][3].weight:0);t.push(w),u.push(p)}a.skinIndices=t,a.skinWeights=u,a.bones=k;for(var x={name:f.ID,fps:30,length:f.frames/30,hierarchy:[]},m=0;m<k.length;m++)x.hierarchy.push({parent:k[m].parent,name:k[m].name,keys:[]});for(console.log("ColladaLoader:",f.ID+" has "+k.length+" bones."),Q(a,g,e),d=0;d<f.frames;d++){var y=[];N(g,y,d),O(y,e.skin);for(var l=0;l<y.length;l++)for(var m=0;m<x.hierarchy.length;m++)if(x.hierarchy[m].name===y[l].sid){var A={};A.time=d/30,A.matrix=y[l].animatrix,0===d&&(y[l].matrix=A.matrix);var B=[new THREE.Vector3,new THREE.Quaternion,new THREE.Vector3];A.matrix.decompose(B[0],B[1],B[2]),A.pos=[B[0].x,B[0].y,B[0].z],A.scl=[B[2].x,B[2].y,B[2].z],A.rot=B[1],x.hierarchy[m].keys.push(A)}a.animation=x}}function S(){if(d&&0===d.joints.length)return void(p=void 0);var e={},f=function(a,f){var g=f.getAttribute("id"),h=c.getChildById(g,!0),i=d.joints[a];b.traverse(function(b){b.colladaId==g&&(e[a]={node:b,transforms:h.transforms,joint:i,position:i.zeroPosition})})};p={joints:d&&d.joints,getJointValue:function(a){var b=e[a];if(b)return b.position;console.log("getJointValue: joint "+a+" doesn't exist")},setJointValue:function(a,b){var c=e[a];if(c){var d=c.joint;if(b>d.limits.max||b<d.limits.min)console.log("setJointValue: joint "+a+" value "+b+" outside of limits (min: "+d.limits.min+", max: "+d.limits.max+")");else if(d.static)console.log("setJointValue: joint "+a+" is static");else{var f=c.node,g=d.axis,i=c.transforms,j=new THREE.Matrix4;for(h=0;h<i.length;h++){var k=i[h];if(k.sid&&-1!==k.sid.indexOf("joint"+a))switch(d.type){case"revolute":j.multiply(l.makeRotationAxis(g,THREE.Math.degToRad(b)));break;case"prismatic":j.multiply(l.makeTranslation(g.x*b,g.y*b,g.z*b));break;default:console.warn("setJointValue: unknown joint type: "+d.type)}else{var l=new THREE.Matrix4;switch(k.type){case"matrix":j.multiply(k.obj);break;case"translate":j.multiply(l.makeTranslation(k.obj.x,k.obj.y,k.obj.z));break;case"rotate":j.multiply(l.makeRotationAxis(k.obj,k.angle))}}}var m=j.elements,n=Array.prototype.slice.call(m),o=[n[0],n[4],n[8],n[12],n[1],n[5],n[9],n[13],n[2],n[6],n[10],n[14],n[3],n[7],n[11],n[15]];f.matrix.set.apply(f.matrix,o),f.matrix.decompose(f.position,f.quaternion,f.scale)}}else console.log("setJointValue: joint "+a+" doesn't exist")}};var g=a.querySelector("scene instance_kinematics_scene");if(g)for(var h=0;h<g.childNodes.length;h++){var i=g.childNodes[h];if(1==i.nodeType)switch(i.nodeName){case"bind_joint_axis":var j=i.getAttribute("target").split("/").pop(),k=i.querySelector("axis param").textContent,l=parseInt(k.split("joint").pop().split(".")[0]),m=a.querySelector('[sid="'+j+'"]');if(m){var n=m.parentElement;f(l,n)}}}}function T(a,b){var e,f,g,h,c=new THREE.Object3D;for(g=0;g<a.controllers.length;g++){var o=i[a.controllers[g].url];switch(o.type){case"skin":if(j[o.skin.source]){var p=new ma;p.url=o.skin.source,p.instance_material=a.controllers[g].instance_material,a.geometries.push(p),!0,e=a.controllers[g]}else if(i[o.skin.source]){var q=i[o.skin.source];if(f=q,q.morph&&j[q.morph.source]){var p=new ma;p.url=q.morph.source,p.instance_material=a.controllers[g].instance_material,a.geometries.push(p)}}break;case"morph":if(j[o.morph.source]){var p=new ma;p.url=o.morph.source,p.instance_material=a.controllers[g].instance_material,a.geometries.push(p),f=a.controllers[g]}console.log("ColladaLoader: Morph-controller partially supported.")}}var r={};for(g=0;g<a.geometries.length;g++){var B,s=a.geometries[g],v=s.instance_material,w=j[s.url],y={},z=[],A=0;if(w){if(!w.mesh||!w.mesh.primitives)continue;if(0===c.name.length&&(c.name=w.id),v)for(h=0;h<v.length;h++){var C=v[h],D=k[C.target],E=D.instance_effect.url,F=l[E].shader,G=F.material;if(w.doubleSided){if(!(C.symbol in r)){var H=G.clone();H.side=THREE.DoubleSide,r[C.symbol]=H}G=r[C.symbol]}G.opacity=G.opacity?G.opacity:1,y[C.symbol]=A,z.push(G),B=G,B.name=null===D.name||""===D.name?D.id:D.name,A++}var I,J=B||new THREE.MeshLambertMaterial({color:14540253,side:w.doubleSided?THREE.DoubleSide:THREE.FrontSide}),K=w.mesh.geometry3js;if(A>1)for(J=new THREE.MultiMaterial(z),h=0;h<K.faces.length;h++){var M=K.faces[h];M.materialIndex=y[M.daeMaterial]}void 0!==e?(R(K,e),K.morphTargets.length>0?(J.morphTargets=!0,J.skinning=!1):(J.morphTargets=!1,J.skinning=!0),I=new THREE.SkinnedMesh(K,J,!1),I.name="skin_"+u.length,u.push(I)):void 0!==f?(L(K,f),J.morphTargets=!0,I=new THREE.Mesh(K,J),I.name="morph_"+t.length,t.push(I)):I=!0===K.isLineStrip?new THREE.Line(K):new THREE.Mesh(K,J),c.add(I)}}for(g=0;g<a.cameras.length;g++){var N=a.cameras[g],O=m[N.url],P=new THREE.PerspectiveCamera(O.yfov,parseFloat(O.aspect_ratio),parseFloat(O.znear),parseFloat(O.zfar));c.add(P)}for(g=0;g<a.lights.length;g++){var Q=null,S=a.lights[g],U=n[S.url];if(U&&U.technique){var V=U.color.getHex(),W=U.intensity,X=U.distance,Y=U.falloff_angle;switch(U.technique){case"directional":Q=new THREE.DirectionalLight(V,W,X),Q.position.set(0,0,1);break;case"point":Q=new THREE.PointLight(V,W,X);break;case"spot":Q=new THREE.SpotLight(V,W,X,Y),Q.position.set(0,0,1);break;case"ambient":Q=new THREE.AmbientLight(V)}}Q&&c.add(Q)}if(c.name=a.name||a.id||"",c.colladaId=a.id||"",c.layer=a.layer||"",c.matrix=a.matrix,c.matrix.decompose(c.position,c.quaternion,c.scale),x.centerGeometry&&c.geometry){var Z=c.geometry.center();Z.multiply(c.scale),Z.applyQuaternion(c.quaternion),c.position.sub(Z)}for(g=0;g<a.nodes.length;g++)c.add(T(a.nodes[g],a));return c}function V(b){for(var c=a.querySelectorAll("library_nodes node"),d=0;d<c.length;d++){var e=c[d].attributes.getNamedItem("id");if(e&&e.value===b)return c[d]}}function W(a){var b=[],c=1e6,d=-1e6;for(var e in h)for(var f=h[e],g=0;g<f.channel.length;g++){var i=f.channel[g],j=f.sampler[g],e=i.target.split("/")[0];e==a.id&&(j.create(),i.sampler=j,c=Math.min(c,j.startTime),d=Math.max(d,j.endTime),b.push(i))}return b.length&&(a.startTime=c,a.endTime=d),b}function Z(a){if(a.channels&&a.channels.length){for(var b=[],c=[],d=0,e=a.channels.length;d<e;d++){var k,f=a.channels[d],g=f.fullSid,h=f.sampler,i=h.input,j=a.getTransformBySid(f.sid);if(f.arrIndices){k=[];for(var l=0,m=f.arrIndices.length;l<m;l++)k[l]=gb(f.arrIndices[l])}else k=hb(f.member);if(j){-1===c.indexOf(g)&&c.push(g);for(var l=0,m=i.length;l<m;l++){var n=i[l],o=h.getData(j.type,l,k),p=$(b,n);if(!p){p=new Ha(n);var q=_(b,n);b.splice(-1===q?b.length:q,0,p)}p.addTarget(g,j,k,o)}}else console.log('Could not find transform "'+f.sid+'" in node '+a.id)}for(var d=0;d<c.length;d++)for(var r=c[d],l=0;l<b.length;l++){var p=b[l];p.hasTarget(r)||aa(b,p,l,r)}a.keys=b,a.sids=c}}function $(a,b){for(var c=null,d=0,e=a.length;d<e&&null===c;d++){var f=a[d];if(f.time===b)c=f;else if(f.time>b)break}return c}function _(a,b){for(var c=-1,d=0,e=a.length;d<e&&-1===c;d++){a[d].time>=b&&(c=d)}return c}function aa(a,b,c,d){var e=ca(a,d,c?c-1:0),f=ba(a,d,c+1);if(e&&f){var k,g=(b.time-e.time)/(f.time-e.time),h=e.getTarget(d),i=f.getTarget(d).data,j=h.data;if("matrix"===h.type)k=j;else if(j.length){k=[];for(var l=0;l<j.length;++l)k[l]=j[l]+(i[l]-j[l])*g}else k=j+(i-j)*g;b.addTarget(d,h.transform,h.member,k)}}function ba(a,b,c){for(;c<a.length;c++){var d=a[c];if(d.hasTarget(b))return d}return null}function ca(a,b,c){for(c=c>=0?c:c+a.length;c>=0;c--){var d=a[c];if(d.hasTarget(b))return d}return null}function da(){this.id="",this.init_from=""}function ea(){this.id="",this.name="",this.type="",this.skin=null,this.morph=null}function fa(){this.method=null,this.source=null,this.targets=null,this.weights=null}function ga(){this.source="",this.bindShapeMatrix=null,this.invBindMatrices=[],this.joints=[],this.weights=[]}function ha(){this.id="",this.name="",this.nodes=[],this.scene=new THREE.Group}function ia(){this.id="",this.name="",this.sid="",this.nodes=[],this.controllers=[],this.transforms=[],this.geometries=[],this.channels=[],this.matrix=new THREE.Matrix4}function ja(){this.sid="",this.type="",this.data=[],this.obj=null}function ka(){this.url="",this.skeleton=[],this.instance_material=[]}function la(){this.symbol="",this.target=""}function ma(){this.url="",this.instance_material=[]}function na(){this.id="",this.mesh=null}function oa(a){this.geometry=a.id,this.primitives=[],this.vertices=null,this.geometry3js=null}function pa(){this.material="",this.count=0,this.inputs=[],this.vcount=null,this.p=[],this.geometry=new THREE.Geometry}function qa(){pa.call(this),this.vcount=[]}function ra(){pa.call(this),this.vcount=1}function sa(){pa.call(this),this.vcount=3}function ta(){this.source="",this.count=0,this.stride=0,this.params=[]}function ua(){this.input={}}function va(){this.semantic="",this.offset=0,this.source="",this.set=0}function wa(a){this.id=a,this.type=null}function xa(){this.id="",this.name="",this.instance_effect=null}function ya(){this.color=new THREE.Color,this.color.setRGB(Math.random(),Math.random(),Math.random()),this.color.a=1,this.texture=null,this.texcoord=null,this.texOpts=null}function za(a,b){this.type=a,this.effect=b,this.material=null}function Aa(a){this.effect=a,this.init_from=null,this.format=null}function Ba(a){this.effect=a,this.source=null,this.wrap_s=null,this.wrap_t=null,this.minfilter=null,this.magfilter=null,this.mipfilter=null}function Ca(){this.id="",this.name="",this.shader=null,this.surface={},this.sampler={}}function Da(){this.url=""}function Ea(){this.id="",this.name="",this.source={},this.sampler=[],this.channel=[]}function Fa(a){this.animation=a,this.source="",this.target="",this.fullSid=null,this.sid=null,this.dotSyntax=null,this.arrSyntax=null,this.arrIndices=null,this.member=null}function Ga(a){this.id="",this.animation=a,this.inputs=[],this.input=null,this.output=null,this.strideOut=null,this.interpolation=null,this.startTime=null,this.endTime=null,this.duration=0}function Ha(a){this.targets=[],this.time=a}function Ia(){this.id="",this.name="",this.technique=""}function Ja(){this.url=""}function Ka(){this.id="",this.name="",this.technique=""}function La(){this.url=""}function Ma(){this.id="",this.name="",this.joints=[],this.links=[]}function Na(){this.sid="",this.name="",this.axis=new THREE.Vector3,this.limits={min:0,max:0},this.type="",this.static=!1,this.zeroPosition=0,this.middlePosition=0}function Oa(){this.sid="",this.name="",this.transforms=[],this.attachments=[]}function Pa(){this.joint="",this.transforms=[],this.links=[]}function Qa(a){var b=a.getAttribute("id");return void 0!=f[b]?f[b]:(f[b]=new wa(b).parse(a),f[b])}function Sa(a){for(var b=Va(a),c=[],d=0,e=b.length;d<e;d++)c.push("true"===b[d]||"1"===b[d]);return c}function Ta(a){for(var b=Va(a),c=[],d=0,e=b.length;d<e;d++)c.push(parseFloat(b[d]));return c}function Ua(a){for(var b=Va(a),c=[],d=0,e=b.length;d<e;d++)c.push(parseInt(b[d],10));return c}function Va(a){return a.length>0?Wa(a).split(/\s+/):[]}function Wa(a){return a.replace(/^\s+/,"").replace(/\s+$/,"")}function Ya(a,b,c){return a.hasAttribute(b)?parseInt(a.getAttribute(b),10):c}function _a(a,b){(new THREE.ImageLoader).load(b,function(b){a.image=b,a.needsUpdate=!0})}function ab(a,b){a.doubleSided=!1;var c=b.querySelectorAll("extra double_sided")[0];c&&c&&1===parseInt(c.textContent,10)&&(a.doubleSided=!0)}function bb(){if(!0!==x.convertUpAxis||z===x.upAxis)A=null;else switch(z){case"X":A="Y"===x.upAxis?"XtoY":"XtoZ";break;case"Y":A="X"===x.upAxis?"YtoX":"YtoZ";break;case"Z":A="X"===x.upAxis?"ZtoX":"ZtoY"}}function cb(a,b){if(!0===x.convertUpAxis&&z!==x.upAxis)switch(A){case"XtoY":var c=a[0];a[0]=b*a[1],a[1]=c;break;case"XtoZ":var c=a[2];a[2]=a[1],a[1]=a[0],a[0]=c;break;case"YtoX":var c=a[0];a[0]=a[1],a[1]=b*c;break;case"YtoZ":var c=a[1];a[1]=b*a[2],a[2]=c;break;case"ZtoX":var c=a[0];a[0]=a[1],a[1]=a[2],a[2]=c;break;case"ZtoY":var c=a[1];a[1]=a[2],a[2]=b*c}}function db(a,b){if(!0!==x.convertUpAxis||z===x.upAxis)return b;switch(a){case"X":b="XtoY"===A?-1*b:b;break;case"Y":b="YtoZ"===A||"YtoX"===A?-1*b:b;break;case"Z":b="ZtoY"===A?-1*b:b}return b}function eb(a,b){var c=[a[b],a[b+1],a[b+2]];return cb(c,-1),new THREE.Vector3(c[0],c[1],c[2])}function fb(a){if(x.convertUpAxis){var b=[a[0],a[4],a[8]];cb(b,-1),a[0]=b[0],a[4]=b[1],a[8]=b[2],b=[a[1],a[5],a[9]],cb(b,-1),a[1]=b[0],a[5]=b[1],a[9]=b[2],b=[a[2],a[6],a[10]],cb(b,-1),a[2]=b[0],a[6]=b[1],a[10]=b[2],b=[a[0],a[1],a[2]],cb(b,-1),a[0]=b[0],a[1]=b[1],a[2]=b[2],b=[a[4],a[5],a[6]],cb(b,-1),a[4]=b[0],a[5]=b[1],a[6]=b[2],b=[a[8],a[9],a[10]],cb(b,-1),a[8]=b[0],a[9]=b[1],a[10]=b[2],b=[a[3],a[7],a[11]],cb(b,-1),a[3]=b[0],a[7]=b[1],a[11]=b[2]}return(new THREE.Matrix4).set(a[0],a[1],a[2],a[3],a[4],a[5],a[6],a[7],a[8],a[9],a[10],a[11],a[12],a[13],a[14],a[15])}function gb(a){if(a>-1&&a<3){var b=["X","Y","Z"],c={X:0,Y:1,Z:2};a=hb(b[a]),a=c[a]}return a}function hb(a){if(x.convertUpAxis)switch(a){case"X":switch(A){case"XtoY":case"XtoZ":case"YtoX":a="Y";break;case"ZtoX":a="Z"}break;case"Y":switch(A){case"XtoY":case"YtoX":case"ZtoX":a="X";break;case"XtoZ":case"YtoZ":case"ZtoY":a="Z"}break;case"Z":switch(A){case"XtoZ":a="X";break;case"YtoZ":case"ZtoX":case"ZtoY":a="Y"}}return a}var c,d,o,p,q,r,s,t,u,a=null,b=null,e=null,f={},g={},h={},i={},j={},k={},l={},m={},n={},w=THREE.SmoothShading,x={centerGeometry:!1,convertUpAxis:!1,subdivideFaces:!0,upAxis:"Y",defaultEnvMap:null},y=1,z="Y",A=null;return da.prototype.parse=function(a){this.id=a.getAttribute("id");for(var b=0;b<a.childNodes.length;b++){var c=a.childNodes[b];"init_from"===c.nodeName&&(this.init_from=c.textContent)}return this},ea.prototype.parse=function(a){this.id=a.getAttribute("id"),this.name=a.getAttribute("name"),this.type="none";for(var b=0;b<a.childNodes.length;b++){var c=a.childNodes[b];switch(c.nodeName){case"skin":this.skin=(new ga).parse(c),this.type=c.nodeName;break;case"morph":this.morph=(new fa).parse(c),this.type=c.nodeName}}return this},fa.prototype.parse=function(a){var d,b={},c=[];for(this.method=a.getAttribute("method"),this.source=a.getAttribute("source").replace(/^#/,""),d=0;d<a.childNodes.length;d++){var e=a.childNodes[d];if(1==e.nodeType)switch(e.nodeName){case"source":var f=(new wa).parse(e);b[f.id]=f;break;case"targets":c=this.parseInputs(e);break;default:console.log(e.nodeName)}}for(d=0;d<c.length;d++){var g=c[d],f=b[g.source];switch(g.semantic){case"MORPH_TARGET":this.targets=f.read();break;case"MORPH_WEIGHT":this.weights=f.read()}}return this},fa.prototype.parseInputs=function(a){for(var b=[],c=0;c<a.childNodes.length;c++){var d=a.childNodes[c];if(1==d.nodeType)switch(d.nodeName){case"input":b.push((new va).parse(d))}}return b},ga.prototype.parse=function(a){var c,d,b={};this.source=a.getAttribute("source").replace(/^#/,""),this.invBindMatrices=[],this.joints=[],this.weights=[];for(var e=0;e<a.childNodes.length;e++){var f=a.childNodes[e];if(1==f.nodeType)switch(f.nodeName){case"bind_shape_matrix":var g=Ta(f.textContent);this.bindShapeMatrix=fb(g);break;case"source":var h=(new wa).parse(f);b[h.id]=h;break;case"joints":c=f;break;case"vertex_weights":d=f;break;default:console.log(f.nodeName)}}return this.parseJoints(c,b),this.parseWeights(d,b),this},ga.prototype.parseJoints=function(a,b){for(var c=0;c<a.childNodes.length;c++){var d=a.childNodes[c];if(1==d.nodeType)switch(d.nodeName){case"input":var e=(new va).parse(d),f=b[e.source];"JOINT"===e.semantic?this.joints=f.read():"INV_BIND_MATRIX"===e.semantic&&(this.invBindMatrices=f.read())}}},ga.prototype.parseWeights=function(a,b){for(var c,d,e=[],f=0;f<a.childNodes.length;f++){var g=a.childNodes[f];if(1==g.nodeType)switch(g.nodeName){case"input":e.push((new va).parse(g));break;case"v":c=Ua(g.textContent);break;case"vcount":d=Ua(g.textContent)}}for(var h=0,f=0;f<d.length;f++){for(var i=d[f],j=[],k=0;k<i;k++){for(var l={},m=0;m<e.length;m++){var n=e[m],o=c[h+n.offset];switch(n.semantic){case"JOINT":l.joint=o;break;case"WEIGHT":l.weight=b[n.source].data[o]}}j.push(l),h+=e.length}for(var k=0;k<j.length;k++)j[k].index=f;this.weights.push(j)}},ha.prototype.getChildById=function(a,b){for(var c=0;c<this.nodes.length;c++){var d=this.nodes[c].getChildById(a,b);if(d)return d}return null},ha.prototype.getChildBySid=function(a,b){for(var c=0;c<this.nodes.length;c++){var d=this.nodes[c].getChildBySid(a,b);if(d)return d}return null},ha.prototype.parse=function(a){this.id=a.getAttribute("id"),this.name=a.getAttribute("name"),this.nodes=[];for(var b=0;b<a.childNodes.length;b++){var c=a.childNodes[b];if(1==c.nodeType)switch(c.nodeName){case"node":this.nodes.push((new ia).parse(c))}}return this},ia.prototype.getChannelForTransform=function(a){for(var b=0;b<this.channels.length;b++){var i,c=this.channels[b],d=c.target.split("/"),f=(d.shift(),d.shift()),g=f.indexOf(".")>=0,h=f.indexOf("(")>=0;if(g)d=f.split("."),f=d.shift(),d.shift();else if(h){i=f.split("("),f=i.shift();for(var k=0;k<i.length;k++)i[k]=parseInt(i[k].replace(/\)/,""))}if(f===a)return c.info={sid:f,dotSyntax:g,arrSyntax:h,arrIndices:i},c}return null},ia.prototype.getChildById=function(a,b){if(this.id===a)return this;if(b)for(var c=0;c<this.nodes.length;c++){var d=this.nodes[c].getChildById(a,b);if(d)return d}return null},ia.prototype.getChildBySid=function(a,b){if(this.sid===a)return this;if(b)for(var c=0;c<this.nodes.length;c++){var d=this.nodes[c].getChildBySid(a,b);if(d)return d}return null},ia.prototype.getTransformBySid=function(a){for(var b=0;b<this.transforms.length;b++)if(this.transforms[b].sid===a)return this.transforms[b];return null},ia.prototype.parse=function(a){var b;this.id=a.getAttribute("id"),this.sid=a.getAttribute("sid"),this.name=a.getAttribute("name"),this.type=a.getAttribute("type"),this.layer=a.getAttribute("layer"),this.type="JOINT"===this.type?this.type:"NODE",this.nodes=[],this.transforms=[],this.geometries=[],this.cameras=[],this.lights=[],this.controllers=[],this.matrix=new THREE.Matrix4;for(var c=0;c<a.childNodes.length;c++){var d=a.childNodes[c];if(1==d.nodeType)switch(d.nodeName){case"node":this.nodes.push((new ia).parse(d));break;case"instance_camera":this.cameras.push((new Ja).parse(d));break;case"instance_controller":this.controllers.push((new ka).parse(d));break;case"instance_geometry":this.geometries.push((new ma).parse(d));break;case"instance_light":this.lights.push((new La).parse(d));break;case"instance_node":b=d.getAttribute("url").replace(/^#/,"");var e=V(b);e&&this.nodes.push((new ia).parse(e));break;case"rotate":case"translate":case"scale":case"matrix":case"lookat":case"skew":this.transforms.push((new ja).parse(d));break;case"extra":break;default:console.log(d.nodeName)}}return this.channels=W(this),Z(this),this.updateMatrix(),this},ia.prototype.updateMatrix=function(){this.matrix.identity();for(var a=0;a<this.transforms.length;a++)this.transforms[a].apply(this.matrix)},ja.prototype.parse=function(a){return this.sid=a.getAttribute("sid"),this.type=a.nodeName,this.data=Ta(a.textContent),this.convert(),this},ja.prototype.convert=function(){switch(this.type){case"matrix":this.obj=fb(this.data);break;case"rotate":this.angle=THREE.Math.degToRad(this.data[3]);case"translate":cb(this.data,-1),this.obj=new THREE.Vector3(this.data[0],this.data[1],this.data[2]);break;case"scale":cb(this.data,1),this.obj=new THREE.Vector3(this.data[0],this.data[1],this.data[2]);break;default:console.log("Can not convert Transform of type "+this.type)}},ja.prototype.apply=function(){var a=new THREE.Matrix4;return function(b){switch(this.type){case"matrix":b.multiply(this.obj);break;case"translate":b.multiply(a.makeTranslation(this.obj.x,this.obj.y,this.obj.z));break;case"rotate":b.multiply(a.makeRotationAxis(this.obj,this.angle));break;case"scale":b.scale(this.obj)}}}(),ja.prototype.update=function(a,b){var c=["X","Y","Z","ANGLE"];switch(this.type){case"matrix":if(b)if(1===b.length)switch(b[0]){case 0:this.obj.n11=a[0],this.obj.n21=a[1],this.obj.n31=a[2],this.obj.n41=a[3];break;case 1:this.obj.n12=a[0],this.obj.n22=a[1],this.obj.n32=a[2],this.obj.n42=a[3];break;case 2:this.obj.n13=a[0],this.obj.n23=a[1],this.obj.n33=a[2],this.obj.n43=a[3];break;case 3:this.obj.n14=a[0],this.obj.n24=a[1],this.obj.n34=a[2],this.obj.n44=a[3]}else if(2===b.length){var d="n"+(b[0]+1)+(b[1]+1);this.obj[d]=a}else console.log("Incorrect addressing of matrix in transform.");else this.obj.copy(a);break;case"translate":case"scale":switch("[object Array]"===Object.prototype.toString.call(b)&&(b=c[b[0]]),b){case"X":this.obj.x=a;break;case"Y":this.obj.y=a;break;case"Z":this.obj.z=a;break;default:this.obj.x=a[0],this.obj.y=a[1],this.obj.z=a[2]}break;case"rotate":switch("[object Array]"===Object.prototype.toString.call(b)&&(b=c[b[0]]),b){case"X":this.obj.x=a;break;case"Y":this.obj.y=a;break;case"Z":this.obj.z=a;break;case"ANGLE":this.angle=THREE.Math.degToRad(a);break;default:this.obj.x=a[0],this.obj.y=a[1],this.obj.z=a[2],this.angle=THREE.Math.degToRad(a[3])}}},ka.prototype.parse=function(a){this.url=a.getAttribute("url").replace(/^#/,""),this.skeleton=[],this.instance_material=[];for(var b=0;b<a.childNodes.length;b++){var c=a.childNodes[b];if(1===c.nodeType)switch(c.nodeName){case"skeleton":this.skeleton.push(c.textContent.replace(/^#/,""));break;case"bind_material":for(var d=c.querySelectorAll("instance_material"),e=0;e<d.length;e++){var f=d[e];this.instance_material.push((new la).parse(f))}}}return this},la.prototype.parse=function(a){return this.symbol=a.getAttribute("symbol"),this.target=a.getAttribute("target").replace(/^#/,""),this},ma.prototype.parse=function(a){this.url=a.getAttribute("url").replace(/^#/,""),this.instance_material=[];for(var b=0;b<a.childNodes.length;b++){var c=a.childNodes[b];if(1==c.nodeType&&"bind_material"===c.nodeName){for(var d=c.querySelectorAll("instance_material"),e=0;e<d.length;e++){var f=d[e];this.instance_material.push((new la).parse(f))}break}}return this},na.prototype.parse=function(a){this.id=a.getAttribute("id"),ab(this,a);for(var b=0;b<a.childNodes.length;b++){var c=a.childNodes[b];switch(c.nodeName){case"mesh":this.mesh=new oa(this).parse(c)}}return this},oa.prototype.parse=function(a){this.primitives=[];for(var b=0;b<a.childNodes.length;b++){var c=a.childNodes[b];switch(c.nodeName){case"source":Qa(c);break;case"vertices":this.vertices=(new ua).parse(c);break;case"linestrips":this.primitives.push((new ra).parse(c));break;case"triangles":this.primitives.push((new sa).parse(c));break;case"polygons":this.primitives.push((new pa).parse(c));break;case"polylist":this.primitives.push((new qa).parse(c))}}if(this.geometry3js=new THREE.Geometry,null===this.vertices)return this;for(var d=f[this.vertices.input.POSITION.source].data,b=0;b<d.length;b+=3)this.geometry3js.vertices.push(eb(d,b).clone());for(var b=0;b<this.primitives.length;b++){var e=this.primitives[b];e.setVertices(this.vertices),this.handlePrimitive(e,this.geometry3js)}return this.geometry3js.calcNormals&&(this.geometry3js.computeVertexNormals(),delete this.geometry3js.calcNormals),this},oa.prototype.handlePrimitive=function(a,b){if(a instanceof ra)return void(b.isLineStrip=!0);var c,d,h,i,j,k,l,e=a.p,g=a.inputs,m=0,n=3,o=0,p=[];for(c=0;c<g.length;c++){h=g[c];var q=h.offset+1;switch(o=o<q?q:o,h.semantic){case"TEXCOORD":p.push(h.set)}}for(var r=0;r<e.length;++r)for(var s=e[r],t=0;t<s.length;){var u=[],v=[],w=null,y=[];for(n=a.vcount?a.vcount.length?a.vcount[m++]:a.vcount:s.length/o,c=0;c<n;c++)for(d=0;d<g.length;d++)switch(h=g[d],k=f[h.source],i=s[t+c*o+h.offset],l=k.accessor.params.length,j=i*l,h.semantic){case"VERTEX":u.push(i);break;case"NORMAL":v.push(eb(k.data,j));break;case"TEXCOORD":w=w||{},void 0===w[h.set]&&(w[h.set]=[]),w[h.set].push(new THREE.Vector2(k.data[j],k.data[j+1]));break;case"COLOR":y.push((new THREE.Color).setRGB(k.data[j],k.data[j+1],k.data[j+2]))}if(0===v.length)if(h=this.vertices.input.NORMAL){k=f[h.source],l=k.accessor.params.length;for(var z=0,A=u.length;z<A;z++)v.push(eb(k.data,u[z]*l))}else b.calcNormals=!0;if(!w&&(w={},h=this.vertices.input.TEXCOORD)){p.push(h.set),k=f[h.source],l=k.accessor.params.length;for(var z=0,A=u.length;z<A;z++)j=u[z]*l,void 0===w[h.set]&&(w[h.set]=[]),w[h.set].push(new THREE.Vector2(k.data[j],1-k.data[j+1]))}if(0===y.length&&(h=this.vertices.input.COLOR)){k=f[h.source],l=k.accessor.params.length;for(var z=0,A=u.length;z<A;z++)j=u[z]*l,y.push((new THREE.Color).setRGB(k.data[j],k.data[j+1],k.data[j+2]))}var D,E,B=null,C=[];if(3===n)C.push(new THREE.Face3(u[0],u[1],u[2],v,y.length?y:new THREE.Color));else if(4===n)C.push(new THREE.Face3(u[0],u[1],u[3],v.length?[v[0].clone(),v[1].clone(),v[3].clone()]:[],y.length?[y[0],y[1],y[3]]:new THREE.Color)),C.push(new THREE.Face3(u[1],u[2],u[3],v.length?[v[1].clone(),v[2].clone(),v[3].clone()]:[],y.length?[y[1],y[2],y[3]]:new THREE.Color));else if(n>4&&x.subdivideFaces){var F=y.length?y:new THREE.Color;for(d=1;d<n-1;)C.push(new THREE.Face3(u[0],u[d],u[d+1],v.length?[v[0].clone(),v[d++].clone(),v[d].clone()]:[],F))}if(C.length)for(var z=0,A=C.length;z<A;z++)for(B=C[z],B.daeMaterial=a.material,b.faces.push(B),d=0;d<p.length;d++)D=w[p[d]],E=n>4?[D[0],D[z+1],D[z+2]]:4===n?0===z?[D[0],D[1],D[3]]:[D[1].clone(),D[2],D[3].clone()]:[D[0],D[1],D[2]],void 0===b.faceVertexUvs[d]&&(b.faceVertexUvs[d]=[]),b.faceVertexUvs[d].push(E);else console.log("dropped face with vcount "+n+" for geometry with id: "+b.id);t+=o*n}},pa.prototype.setVertices=function(a){for(var b=0;b<this.inputs.length;b++)this.inputs[b].source===a.id&&(this.inputs[b].source=a.input.POSITION.source)},pa.prototype.parse=function(a){this.material=a.getAttribute("material"),this.count=Ya(a,"count",0);for(var b=0;b<a.childNodes.length;b++){var c=a.childNodes[b];switch(c.nodeName){case"input":this.inputs.push((new va).parse(a.childNodes[b]));break;case"vcount":this.vcount=Ua(c.textContent);break;case"p":this.p.push(Ua(c.textContent));break;case"ph":console.warn("polygon holes not yet supported!")}}return this},qa.prototype=Object.create(pa.prototype),qa.prototype.constructor=qa,ra.prototype=Object.create(pa.prototype),ra.prototype.constructor=ra,sa.prototype=Object.create(pa.prototype),sa.prototype.constructor=sa,ta.prototype.parse=function(a){this.params=[],this.source=a.getAttribute("source"),this.count=Ya(a,"count",0),this.stride=Ya(a,"stride",0);for(var b=0;b<a.childNodes.length;b++){var c=a.childNodes[b];if("param"===c.nodeName){var d={};d.name=c.getAttribute("name"),d.type=c.getAttribute("type"),this.params.push(d)}}return this},ua.prototype.parse=function(a){this.id=a.getAttribute("id");for(var b=0;b<a.childNodes.length;b++)if("input"===a.childNodes[b].nodeName){var c=(new va).parse(a.childNodes[b]);this.input[c.semantic]=c}return this},va.prototype.parse=function(a){return this.semantic=a.getAttribute("semantic"),this.source=a.getAttribute("source").replace(/^#/,""),this.set=Ya(a,"set",-1),this.offset=Ya(a,"offset",0),"TEXCOORD"===this.semantic&&this.set<0&&(this.set=0),this},wa.prototype.parse=function(a){this.id=a.getAttribute("id");for(var b=0;b<a.childNodes.length;b++){var c=a.childNodes[b];switch(c.nodeName){case"bool_array":this.data=Sa(c.textContent),this.type=c.nodeName;break;case"float_array":this.data=Ta(c.textContent),this.type=c.nodeName;break;case"int_array":this.data=Ua(c.textContent),this.type=c.nodeName;break;case"IDREF_array":case"Name_array":this.data=Va(c.textContent),this.type=c.nodeName;break;case"technique_common":for(var d=0;d<c.childNodes.length;d++)if("accessor"===c.childNodes[d].nodeName){this.accessor=(new ta).parse(c.childNodes[d]);break}}}return this},wa.prototype.read=function(){var a=[],b=this.accessor.params[0];switch(b.type){case"IDREF":case"Name":case"name":case"float":return this.data;case"float4x4":for(var c=0;c<this.data.length;c+=16){var d=this.data.slice(c,c+16),e=fb(d);a.push(e)}break;default:console.log("ColladaLoader: Source: Read dont know how to read "+b.type+".")}return a},xa.prototype.parse=function(a){this.id=a.getAttribute("id"),this.name=a.getAttribute("name");for(var b=0;b<a.childNodes.length;b++)if("instance_effect"===a.childNodes[b].nodeName){this.instance_effect=(new Da).parse(a.childNodes[b]);break}return this},ya.prototype.isColor=function(){return null===this.texture},ya.prototype.isTexture=function(){return null!=this.texture},ya.prototype.parse=function(a){"transparent"===a.nodeName&&(this.opaque=a.getAttribute("opaque"));for(var b=0;b<a.childNodes.length;b++){var c=a.childNodes[b];if(1==c.nodeType)switch(c.nodeName){case"color":var d=Ta(c.textContent);this.color=new THREE.Color,this.color.setRGB(d[0],d[1],d[2]),this.color.a=d[3];break;case"texture":this.texture=c.getAttribute("texture"),this.texcoord=c.getAttribute("texcoord"),this.texOpts={offsetU:0,offsetV:0,repeatU:1,repeatV:1,wrapU:1,wrapV:1},this.parseTexture(c)}}return this},ya.prototype.parseTexture=function(a){if(!a.childNodes)return this;a.childNodes[1]&&"extra"===a.childNodes[1].nodeName&&(a=a.childNodes[1],a.childNodes[1]&&"technique"===a.childNodes[1].nodeName&&(a=a.childNodes[1]));for(var b=0;b<a.childNodes.length;b++){var c=a.childNodes[b];switch(c.nodeName){case"offsetU":case"offsetV":case"repeatU":case"repeatV":this.texOpts[c.nodeName]=parseFloat(c.textContent);break;case"wrapU":case"wrapV":"TRUE"===c.textContent.toUpperCase()?this.texOpts[c.nodeName]=1:this.texOpts[c.nodeName]=parseInt(c.textContent);break;default:this.texOpts[c.nodeName]=c.textContent}}return this},za.prototype.parse=function(a){for(var b=0;b<a.childNodes.length;b++){var c=a.childNodes[b];if(1==c.nodeType)switch(c.nodeName){case"emission":case"diffuse":case"specular":case"transparent":this[c.nodeName]=(new ya).parse(c);break;case"bump":var d=c.getAttribute("bumptype");d?"heightfield"===d.toLowerCase()?this.bump=(new ya).parse(c):"normalmap"===d.toLowerCase()?this.normal=(new ya).parse(c):(console.error("Shader.prototype.parse: Invalid value for attribute 'bumptype' ("+d+") - valid bumptypes are 'HEIGHTFIELD' and 'NORMALMAP' - defaulting to 'HEIGHTFIELD'"),this.bump=(new ya).parse(c)):(console.warn("Shader.prototype.parse: Attribute 'bumptype' missing from bump node - defaulting to 'HEIGHTFIELD'"),this.bump=(new ya).parse(c));break;case"shininess":case"reflectivity":case"index_of_refraction":case"transparency":var e=c.querySelectorAll("float");e.length>0&&(this[c.nodeName]=parseFloat(e[0].textContent))}}return this.create(),this},za.prototype.create=function(){var a={},b=!1;if(void 0!==this.transparency&&void 0!==this.transparent){var d=(this.transparent,(this.transparent.color.r+this.transparent.color.g+this.transparent.color.b)/3*this.transparency);d>0&&(b=!0,a.transparent=!0,a.opacity=1-d)}var e={diffuse:"map",ambient:"lightMap",specular:"specularMap",emission:"emissionMap",bump:"bumpMap",normal:"normalMap"};for(var f in this)switch(f){case"ambient":case"emission":case"diffuse":case"specular":case"bump":case"normal":var h=this[f];if(h instanceof ya)if(h.isTexture()){var i=h.texture,j=this.effect.sampler[i];if(void 0!==j&&void 0!==j.source){var k=this.effect.surface[j.source];if(void 0!==k){var l=g[k.init_from];if(l){var n,m=s+l.init_from,o=THREE.Loader.Handlers.get(m);null!==o?n=o.load(m):(n=new THREE.Texture,_a(n,m)),"MIRROR"===j.wrap_s?n.wrapS=THREE.MirroredRepeatWrapping:"WRAP"===j.wrap_s||h.texOpts.wrapU?n.wrapS=THREE.RepeatWrapping:n.wrapS=THREE.ClampToEdgeWrapping,"MIRROR"===j.wrap_t?n.wrapT=THREE.MirroredRepeatWrapping:"WRAP"===j.wrap_t||h.texOpts.wrapV?n.wrapT=THREE.RepeatWrapping:n.wrapT=THREE.ClampToEdgeWrapping,n.offset.x=h.texOpts.offsetU,n.offset.y=h.texOpts.offsetV,n.repeat.x=h.texOpts.repeatU,n.repeat.y=h.texOpts.repeatV,a[e[f]]=n,"emission"===f&&(a.emissive=16777215)}}}}else"diffuse"!==f&&b||("emission"===f?a.emissive=h.color.getHex():a[f]=h.color.getHex());break;case"shininess":a[f]=this[f];break;case"reflectivity":a[f]=this[f],a[f]>0&&(a.envMap=x.defaultEnvMap),a.combine=THREE.MixOperation;break;case"index_of_refraction":a.refractionRatio=this[f],1!==this[f]&&(a.envMap=x.defaultEnvMap)}switch(a.shading=w,a.side=this.effect.doubleSided?THREE.DoubleSide:THREE.FrontSide,void 0!==a.diffuse&&(a.color=a.diffuse,delete a.diffuse),this.type){case"constant":void 0!=a.emissive&&(a.color=a.emissive),this.material=new THREE.MeshBasicMaterial(a);break;case"phong":case"blinn":this.material=new THREE.MeshPhongMaterial(a);break;case"lambert":default:this.material=new THREE.MeshLambertMaterial(a)}return this.material},Aa.prototype.parse=function(a){for(var b=0;b<a.childNodes.length;b++){var c=a.childNodes[b];if(1==c.nodeType)switch(c.nodeName){case"init_from":this.init_from=c.textContent;break;case"format":this.format=c.textContent;break;default:console.log("unhandled Surface prop: "+c.nodeName)}}return this},Ba.prototype.parse=function(a){for(var b=0;b<a.childNodes.length;b++){var c=a.childNodes[b];if(1==c.nodeType)switch(c.nodeName){case"source":this.source=c.textContent;break;case"minfilter":this.minfilter=c.textContent;break;case"magfilter":this.magfilter=c.textContent;break;case"mipfilter":this.mipfilter=c.textContent;break;case"wrap_s":this.wrap_s=c.textContent;break;case"wrap_t":this.wrap_t=c.textContent;break;default:console.log("unhandled Sampler2D prop: "+c.nodeName)}}return this},Ca.prototype.create=function(){if(null===this.shader)return null},Ca.prototype.parse=function(a){this.id=a.getAttribute("id"),this.name=a.getAttribute("name"),ab(this,a),this.shader=null;for(var b=0;b<a.childNodes.length;b++){var c=a.childNodes[b];if(1==c.nodeType)switch(c.nodeName){case"profile_COMMON":this.parseTechnique(this.parseProfileCOMMON(c))}}return this},Ca.prototype.parseNewparam=function(a){for(var b=a.getAttribute("sid"),c=0;c<a.childNodes.length;c++){var d=a.childNodes[c];if(1==d.nodeType)switch(d.nodeName){case"surface":this.surface[b]=new Aa(this).parse(d);break;case"sampler2D":this.sampler[b]=new Ba(this).parse(d);break;case"extra":break;default:console.log(d.nodeName)}}},Ca.prototype.parseProfileCOMMON=function(a){for(var b,c=0;c<a.childNodes.length;c++){var d=a.childNodes[c];if(1==d.nodeType)switch(d.nodeName){case"profile_COMMON":this.parseProfileCOMMON(d);break;case"technique":b=d;break;case"newparam":this.parseNewparam(d);break;case"image":var e=(new da).parse(d);g[e.id]=e;break;case"extra":break;default:console.log(d.nodeName)}}return b},Ca.prototype.parseTechnique=function(a){for(var b=0;b<a.childNodes.length;b++){var c=a.childNodes[b];if(1==c.nodeType)switch(c.nodeName){case"constant":case"lambert":case"blinn":case"phong":this.shader=new za(c.nodeName,this).parse(c);break;case"extra":this.parseExtra(c)}}},Ca.prototype.parseExtra=function(a){for(var b=0;b<a.childNodes.length;b++){var c=a.childNodes[b];if(1==c.nodeType)switch(c.nodeName){case"technique":this.parseExtraTechnique(c)}}},Ca.prototype.parseExtraTechnique=function(a){for(var b=0;b<a.childNodes.length;b++){var c=a.childNodes[b];if(1==c.nodeType)switch(c.nodeName){case"bump":this.shader.parse(a)}}},Da.prototype.parse=function(a){return this.url=a.getAttribute("url").replace(/^#/,""),this},Ea.prototype.parse=function(a){this.id=a.getAttribute("id"),this.name=a.getAttribute("name"),this.source={};for(var b=0;b<a.childNodes.length;b++){var c=a.childNodes[b];if(1==c.nodeType)switch(c.nodeName){case"animation":var d=(new Ea).parse(c);for(var e in d.source)this.source[e]=d.source[e];for(var f=0;f<d.channel.length;f++)this.channel.push(d.channel[f]),this.sampler.push(d.sampler[f]);break;case"source":var e=(new wa).parse(c);this.source[e.id]=e;break;case"sampler":this.sampler.push(new Ga(this).parse(c));break;case"channel":this.channel.push(new Fa(this).parse(c))}}return this},Fa.prototype.parse=function(a){this.source=a.getAttribute("source").replace(/^#/,""),this.target=a.getAttribute("target");var b=this.target.split("/"),d=(b.shift(),b.shift()),e=d.indexOf(".")>=0,f=d.indexOf("(")>=0;if(e)b=d.split("."),this.sid=b.shift(),this.member=b.shift();else if(f){var g=d.split("(");this.sid=g.shift();for(var h=0;h<g.length;h++)g[h]=parseInt(g[h].replace(/\)/,""));this.arrIndices=g}else this.sid=d;return this.fullSid=d,this.dotSyntax=e,this.arrSyntax=f,this},Ga.prototype.parse=function(a){this.id=a.getAttribute("id"),this.inputs=[];for(var b=0;b<a.childNodes.length;b++){var c=a.childNodes[b];if(1==c.nodeType)switch(c.nodeName){case"input":this.inputs.push((new va).parse(c))}}return this},Ga.prototype.create=function(){for(var a=0;a<this.inputs.length;a++){var b=this.inputs[a],c=this.animation.source[b.source];switch(b.semantic){case"INPUT":this.input=c.read();break;case"OUTPUT":this.output=c.read(),this.strideOut=c.accessor.stride;break;case"INTERPOLATION":this.interpolation=c.read();break;case"IN_TANGENT":case"OUT_TANGENT":break;default:console.log(b.semantic)}}if(this.startTime=0,this.endTime=0,this.duration=0,this.input.length){this.startTime=1e8,this.endTime=-1e8;for(var a=0;a<this.input.length;a++)this.startTime=Math.min(this.startTime,this.input[a]),this.endTime=Math.max(this.endTime,this.input[a]);this.duration=this.endTime-this.startTime}},Ga.prototype.getData=function(a,b,c){var d;if("matrix"===a&&16===this.strideOut)d=this.output[b];else if(this.strideOut>1){d=[],b*=this.strideOut;for(var e=0;e<this.strideOut;++e)d[e]=this.output[b+e];if(3===this.strideOut)switch(a){case"rotate":case"translate":cb(d,-1);break;case"scale":cb(d,1)}else 4===this.strideOut&&"matrix"===a&&cb(d,-1)}else d=this.output[b],c&&"translate"===a&&(d=db(c,d));return d},Ha.prototype.addTarget=function(a,b,c,d){this.targets.push({sid:a,member:c,transform:b,data:d})},Ha.prototype.apply=function(a){for(var b=0;b<this.targets.length;++b){var c=this.targets[b];a&&c.sid!==a||c.transform.update(c.data,c.member)}},Ha.prototype.getTarget=function(a){for(var b=0;b<this.targets.length;++b)if(this.targets[b].sid===a)return this.targets[b];return null},Ha.prototype.hasTarget=function(a){for(var b=0;b<this.targets.length;++b)if(this.targets[b].sid===a)return!0;return!1},Ha.prototype.interpolate=function(a,b){for(var c=0,d=this.targets.length;c<d;c++){var g,e=this.targets[c],f=a.getTarget(e.sid);if("matrix"!==e.transform.type&&f){var h=(b-this.time)/(a.time-this.time),i=f.data,j=e.data;if(h<0&&(h=0),h>1&&(h=1),j.length){g=[];for(var k=0;k<j.length;++k)g[k]=j[k]+(i[k]-j[k])*h}else g=j+(i-j)*h}else g=e.data;e.transform.update(g,e.member)}},Ia.prototype.parse=function(a){this.id=a.getAttribute("id"),this.name=a.getAttribute("name");for(var b=0;b<a.childNodes.length;b++){var c=a.childNodes[b];if(1==c.nodeType)switch(c.nodeName){case"optics":this.parseOptics(c)}}return this},Ia.prototype.parseOptics=function(a){for(var b=0;b<a.childNodes.length;b++)if("technique_common"===a.childNodes[b].nodeName)for(var c=a.childNodes[b],d=0;d<c.childNodes.length;d++)if(this.technique=c.childNodes[d].nodeName,"perspective"===this.technique)for(var e=c.childNodes[d],f=0;f<e.childNodes.length;f++){var g=e.childNodes[f];switch(g.nodeName){case"yfov":this.yfov=g.textContent;break;case"xfov":this.xfov=g.textContent;break;case"znear":this.znear=g.textContent;break;case"zfar":this.zfar=g.textContent;break;case"aspect_ratio":this.aspect_ratio=g.textContent}}else if("orthographic"===this.technique)for(var h=c.childNodes[d],f=0;f<h.childNodes.length;f++){var g=h.childNodes[f];switch(g.nodeName){case"xmag":this.xmag=g.textContent;break;case"ymag":this.ymag=g.textContent;break;case"znear":this.znear=g.textContent;break;case"zfar":this.zfar=g.textContent;break;case"aspect_ratio":this.aspect_ratio=g.textContent}}return this},Ja.prototype.parse=function(a){return this.url=a.getAttribute("url").replace(/^#/,""),this},Ka.prototype.parse=function(a){this.id=a.getAttribute("id"),this.name=a.getAttribute("name");for(var b=0;b<a.childNodes.length;b++){var c=a.childNodes[b];if(1==c.nodeType)switch(c.nodeName){case"technique_common":this.parseCommon(c);break;case"technique":this.parseTechnique(c)}}return this},Ka.prototype.parseCommon=function(a){for(var b=0;b<a.childNodes.length;b++)switch(a.childNodes[b].nodeName){case"directional":case"point":case"spot":case"ambient":this.technique=a.childNodes[b].nodeName;for(var c=a.childNodes[b],d=0;d<c.childNodes.length;d++){var e=c.childNodes[d];switch(e.nodeName){case"color":var f=Ta(e.textContent);this.color=new THREE.Color(0),this.color.setRGB(f[0],f[1],f[2]),this.color.a=f[3];break;case"falloff_angle":this.falloff_angle=parseFloat(e.textContent);break;case"quadratic_attenuation":var g=parseFloat(e.textContent);this.distance=g?Math.sqrt(1/g):0}}}return this},Ka.prototype.parseTechnique=function(a){this.profile=a.getAttribute("profile");for(var b=0;b<a.childNodes.length;b++){var c=a.childNodes[b];switch(c.nodeName){case"intensity":this.intensity=parseFloat(c.textContent)}}return this},La.prototype.parse=function(a){return this.url=a.getAttribute("url").replace(/^#/,""),this},Ma.prototype.parse=function(a){this.id=a.getAttribute("id"),this.name=a.getAttribute("name"),this.joints=[],this.links=[];for(var b=0;b<a.childNodes.length;b++){var c=a.childNodes[b];if(1==c.nodeType)switch(c.nodeName){case"technique_common":this.parseCommon(c)}}return this},Ma.prototype.parseCommon=function(a){for(var b=0;b<a.childNodes.length;b++){var c=a.childNodes[b];if(1==c.nodeType)switch(a.childNodes[b].nodeName){case"joint":this.joints.push((new Na).parse(c));break;case"link":this.links.push((new Oa).parse(c))}}return this},Na.prototype.parse=function(a){this.sid=a.getAttribute("sid"),this.name=a.getAttribute("name"),this.axis=new THREE.Vector3,this.limits={min:0,max:0},this.type="",this.static=!1,this.zeroPosition=0,this.middlePosition=0;var b=a.querySelector("axis"),c=Ta(b.textContent);this.axis=eb(c,0);var d=a.querySelector("limits min")?parseFloat(a.querySelector("limits min").textContent):-360,e=a.querySelector("limits max")?parseFloat(a.querySelector("limits max").textContent):360;this.limits={min:d,max:e};for(var f=["prismatic","revolute"],g=0;g<f.length;g++){var h=f[g];a.querySelector(h)&&(this.type=h)}return this.limits.min>=this.limits.max&&(this.static=!0),this.middlePosition=(this.limits.min+this.limits.max)/2,this},Oa.prototype.parse=function(a){this.sid=a.getAttribute("sid"),this.name=a.getAttribute("name"),this.transforms=[],this.attachments=[];for(var b=0;b<a.childNodes.length;b++){var c=a.childNodes[b];if(1==c.nodeType)switch(c.nodeName){case"attachment_full":this.attachments.push((new Pa).parse(c));break;case"rotate":case"translate":case"matrix":this.transforms.push((new ja).parse(c))}}return this},Pa.prototype.parse=function(a){this.joint=a.getAttribute("joint").split("/").pop(),this.links=[];for(var b=0;b<a.childNodes.length;b++){var c=a.childNodes[b];if(1==c.nodeType)switch(c.nodeName){case"link":this.links.push((new Oa).parse(c));break;case"rotate":case"translate":case"matrix":this.transforms.push((new ja).parse(c))}}return this},{load:B,parse:C,setPreferredShading:D,applySkin:R,geometries:j,options:x}},THREE.CopyShader={uniforms:{tDiffuse:{type:"t",value:null},opacity:{type:"f",value:1}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform float opacity;","uniform sampler2D tDiffuse;","varying vec2 vUv;","void main() {","vec4 texel = texture2D( tDiffuse, vUv );","gl_FragColor = opacity * texel;","}"].join("\n")},function(a,b){"object"==typeof exports&&"object"==typeof module?module.exports=b():"function"==typeof define&&define.amd?define([],b):"object"==typeof exports?exports.dat=b():a.dat=b()}(this,function(){return function(a){function b(d){if(c[d])return c[d].exports;var e=c[d]={exports:{},id:d,loaded:!1};return a[d].call(e.exports,e,e.exports,b),e.loaded=!0,e.exports}var c={};return b.m=a,b.c=c,b.p="",b(0)}([function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}var e=c(1),f=d(e);a.exports=f.default},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}b.__esModule=!0;var e=c(2),f=d(e),g=c(6),h=d(g),i=c(3),j=d(i),k=c(7),l=d(k),m=c(8),n=d(m),o=c(10),p=d(o),q=c(11),r=d(q),s=c(12),t=d(s),u=c(13),v=d(u),w=c(14),x=d(w),y=c(15),z=d(y),A=c(16),B=d(A),C=c(9),D=d(C),E=c(17),F=d(E);b.default={color:{Color:f.default,math:h.default,interpret:j.default},controllers:{Controller:l.default,BooleanController:n.default,OptionController:p.default,StringController:r.default,NumberController:t.default,NumberControllerBox:v.default,NumberControllerSlider:x.default,FunctionController:z.default,ColorController:B.default},dom:{dom:D.default},gui:{GUI:F.default},GUI:F.default}},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function f(a,b,c){Object.defineProperty(a,b,{get:function(){return"RGB"===this.__state.space?this.__state[b]:(p.recalculateRGB(this,b,c),this.__state[b])},set:function(a){"RGB"!==this.__state.space&&(p.recalculateRGB(this,b,c),this.__state.space="RGB"),this.__state[b]=a}})}function g(a,b){Object.defineProperty(a,b,{get:function(){return"HSV"===this.__state.space?this.__state[b]:(p.recalculateHSV(this),this.__state[b])},set:function(a){"HSV"!==this.__state.space&&(p.recalculateHSV(this),this.__state.space="HSV"),this.__state[b]=a}})}b.__esModule=!0;var h=c(3),i=d(h),j=c(6),k=d(j),l=c(4),m=d(l),n=c(5),o=d(n),p=function(){function a(){if(e(this,a),this.__state=i.default.apply(this,arguments),!1===this.__state)throw new Error("Failed to interpret color arguments");this.__state.a=this.__state.a||1}return a.prototype.toString=function(){return(0,m.default)(this)},a.prototype.toHexString=function(){return(0,m.default)(this,!0)},a.prototype.toOriginal=function(){return this.__state.conversion.write(this)},a}();p.recalculateRGB=function(a,b,c){if("HEX"===a.__state.space)a.__state[b]=k.default.component_from_hex(a.__state.hex,c);else{if("HSV"!==a.__state.space)throw new Error("Corrupted color state");o.default.extend(a.__state,k.default.hsv_to_rgb(a.__state.h,a.__state.s,a.__state.v))}},p.recalculateHSV=function(a){var b=k.default.rgb_to_hsv(a.r,a.g,a.b);o.default.extend(a.__state,{s:b.s,v:b.v}),o.default.isNaN(b.h)?o.default.isUndefined(a.__state.h)&&(a.__state.h=0):a.__state.h=b.h},p.COMPONENTS=["r","g","b","h","s","v","hex","a"],f(p.prototype,"r",2),f(p.prototype,"g",1),f(p.prototype,"b",0),g(p.prototype,"h"),g(p.prototype,"s"),g(p.prototype,"v"),Object.defineProperty(p.prototype,"a",{get:function(){return this.__state.a},set:function(a){this.__state.a=a}}),Object.defineProperty(p.prototype,"hex",{get:function(){return"HEX"!==!this.__state.space&&(this.__state.hex=k.default.rgb_to_hex(this.r,this.g,this.b)),this.__state.hex},set:function(a){this.__state.space="HEX",this.__state.hex=a}}),b.default=p},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}b.__esModule=!0;var e=c(4),f=d(e),g=c(5),h=d(g),i=[{litmus:h.default.isString,conversions:{THREE_CHAR_HEX:{read:function(a){var b=a.match(/^#([A-F0-9])([A-F0-9])([A-F0-9])$/i);return null!==b&&{space:"HEX",hex:parseInt("0x"+b[1].toString()+b[1].toString()+b[2].toString()+b[2].toString()+b[3].toString()+b[3].toString(),0)}},write:f.default},SIX_CHAR_HEX:{read:function(a){var b=a.match(/^#([A-F0-9]{6})$/i);return null!==b&&{space:"HEX",hex:parseInt("0x"+b[1].toString(),0)}},write:f.default},CSS_RGB:{read:function(a){var b=a.match(/^rgb\(\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*\)/);return null!==b&&{space:"RGB",r:parseFloat(b[1]),g:parseFloat(b[2]),b:parseFloat(b[3])}},write:f.default},CSS_RGBA:{read:function(a){var b=a.match(/^rgba\(\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*\)/);return null!==b&&{space:"RGB",r:parseFloat(b[1]),g:parseFloat(b[2]),b:parseFloat(b[3]),a:parseFloat(b[4])}},write:f.default}}},{litmus:h.default.isNumber,conversions:{HEX:{read:function(a){return{space:"HEX",hex:a,conversionName:"HEX"}},write:function(a){return a.hex}}}},{litmus:h.default.isArray,conversions:{RGB_ARRAY:{read:function(a){return 3===a.length&&{space:"RGB",r:a[0],g:a[1],b:a[2]}},write:function(a){return[a.r,a.g,a.b]}},RGBA_ARRAY:{read:function(a){return 4===a.length&&{space:"RGB",r:a[0],g:a[1],b:a[2],a:a[3]}},write:function(a){return[a.r,a.g,a.b,a.a]}}}},{litmus:h.default.isObject,conversions:{RGBA_OBJ:{read:function(a){return!!(h.default.isNumber(a.r)&&h.default.isNumber(a.g)&&h.default.isNumber(a.b)&&h.default.isNumber(a.a))&&{space:"RGB",r:a.r,g:a.g,b:a.b,a:a.a}},write:function(a){return{r:a.r,g:a.g,b:a.b,a:a.a}}},RGB_OBJ:{read:function(a){return!!(h.default.isNumber(a.r)&&h.default.isNumber(a.g)&&h.default.isNumber(a.b))&&{space:"RGB",r:a.r,g:a.g,b:a.b}},write:function(a){return{r:a.r,g:a.g,b:a.b}}},HSVA_OBJ:{read:function(a){return!!(h.default.isNumber(a.h)&&h.default.isNumber(a.s)&&h.default.isNumber(a.v)&&h.default.isNumber(a.a))&&{space:"HSV",h:a.h,s:a.s,v:a.v,a:a.a}},write:function(a){return{h:a.h,s:a.s,v:a.v,a:a.a}}},HSV_OBJ:{read:function(a){return!!(h.default.isNumber(a.h)&&h.default.isNumber(a.s)&&h.default.isNumber(a.v))&&{space:"HSV",h:a.h,s:a.s,v:a.v}},write:function(a){return{h:a.h,s:a.s,v:a.v}}}}}],j=void 0,k=void 0,l=function(){k=!1;var a=arguments.length>1?h.default.toArray(arguments):arguments[0];return h.default.each(i,function(b){if(b.litmus(a))return h.default.each(b.conversions,function(b,c){if(j=b.read(a),!1===k&&!1!==j)return k=j,j.conversionName=c,j.conversion=b,h.default.BREAK}),h.default.BREAK}),k};b.default=l},function(a,b){"use strict";b.__esModule=!0,b.default=function(a,b){var c=a.__state.conversionName.toString(),d=Math.round(a.r),e=Math.round(a.g),f=Math.round(a.b),g=a.a,h=Math.round(a.h),i=a.s.toFixed(1),j=a.v.toFixed(1);if(b||"THREE_CHAR_HEX"===c||"SIX_CHAR_HEX"===c){for(var k=a.hex.toString(16);k.length<6;)k="0"+k;return"#"+k}return"CSS_RGB"===c?"rgb("+d+","+e+","+f+")":"CSS_RGBA"===c?"rgba("+d+","+e+","+f+","+g+")":"HEX"===c?"0x"+a.hex.toString(16):"RGB_ARRAY"===c?"["+d+","+e+","+f+"]":"RGBA_ARRAY"===c?"["+d+","+e+","+f+","+g+"]":"RGB_OBJ"===c?"{r:"+d+",g:"+e+",b:"+f+"}":"RGBA_OBJ"===c?"{r:"+d+",g:"+e+",b:"+f+",a:"+g+"}":"HSV_OBJ"===c?"{h:"+h+",s:"+i+",v:"+j+"}":"HSVA_OBJ"===c?"{h:"+h+",s:"+i+",v:"+j+",a:"+g+"}":"unknown format"}},function(a,b){"use strict";b.__esModule=!0;var c=Array.prototype.forEach,d=Array.prototype.slice,e={BREAK:{},extend:function(a){return this.each(d.call(arguments,1),function(b){(this.isObject(b)?Object.keys(b):[]).forEach(function(c){this.isUndefined(b[c])||(a[c]=b[c])}.bind(this))},this),a},defaults:function(a){return this.each(d.call(arguments,1),function(b){(this.isObject(b)?Object.keys(b):[]).forEach(function(c){this.isUndefined(a[c])&&(a[c]=b[c])}.bind(this))},this),a},compose:function(){var a=d.call(arguments);return function(){for(var b=d.call(arguments),c=a.length-1;c>=0;c--)b=[a[c].apply(this,b)];return b[0]}},each:function(a,b,d){if(a)if(c&&a.forEach&&a.forEach===c)a.forEach(b,d);else if(a.length===a.length+0){var e=void 0,f=void 0;for(e=0,f=a.length;e<f;e++)if(e in a&&b.call(d,a[e],e)===this.BREAK)return}else for(var g in a)if(b.call(d,a[g],g)===this.BREAK)return},defer:function(a){setTimeout(a,0)},debounce:function(a,b){var c=void 0;return function(){function d(){c=null}var e=this,f=arguments,g=!c;clearTimeout(c),c=setTimeout(d,b),g&&a.apply(e,f)}},toArray:function(a){return a.toArray?a.toArray():d.call(a)},isUndefined:function(a){return void 0===a},isNull:function(a){return null===a},isNaN:function(a){function b(b){return a.apply(this,arguments)}return b.toString=function(){return a.toString()},b}(function(a){return isNaN(a)}),isArray:Array.isArray||function(a){return a.constructor===Array},isObject:function(a){return a===Object(a)},isNumber:function(a){return a===a+0},isString:function(a){return a===a+""},isBoolean:function(a){return!1===a||!0===a},isFunction:function(a){return"[object Function]"===Object.prototype.toString.call(a)}};b.default=e},function(a,b){"use strict";b.__esModule=!0;var c=void 0,d={hsv_to_rgb:function(a,b,c){var d=Math.floor(a/60)%6,e=a/60-Math.floor(a/60),f=c*(1-b),g=c*(1-e*b),h=c*(1-(1-e)*b),i=[[c,h,f],[g,c,f],[f,c,h],[f,g,c],[h,f,c],[c,f,g]][d];return{r:255*i[0],g:255*i[1],b:255*i[2]}},rgb_to_hsv:function(a,b,c){var d=Math.min(a,b,c),e=Math.max(a,b,c),f=e-d,g=void 0,h=void 0;return 0===e?{h:NaN,s:0,v:0}:(h=f/e,g=a===e?(b-c)/f:b===e?2+(c-a)/f:4+(a-b)/f,g/=6,g<0&&(g+=1),{h:360*g,s:h,v:e/255})},rgb_to_hex:function(a,b,c){var d=this.hex_with_component(0,2,a);return d=this.hex_with_component(d,1,b),d=this.hex_with_component(d,0,c)},component_from_hex:function(a,b){return a>>8*b&255},hex_with_component:function(a,b,d){return d<<(c=8*b)|a&~(255<<c)}};b.default=d},function(a,b){"use strict";function c(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}b.__esModule=!0;var d=function(){function a(b,d){c(this,a),this.initialValue=b[d],this.domElement=document.createElement("div"),this.object=b,this.property=d,this.__onChange=void 0,this.__onFinishChange=void 0}return a.prototype.onChange=function(a){return this.__onChange=a,this},a.prototype.onFinishChange=function(a){return this.__onFinishChange=a,this},a.prototype.setValue=function(a){return this.object[this.property]=a,this.__onChange&&this.__onChange.call(this,a),this.updateDisplay(),this},a.prototype.getValue=function(){return this.object[this.property]},a.prototype.updateDisplay=function(){return this},a.prototype.isModified=function(){return this.initialValue!==this.getValue()},a}();b.default=d},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function f(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!=typeof b&&"function"!=typeof b?a:b}function g(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}b.__esModule=!0;var h=c(7),i=d(h),j=c(9),k=d(j),l=function(a){function b(c,d){function g(){i.setValue(!i.__prev)}e(this,b);var h=f(this,a.call(this,c,d)),i=h;return h.__prev=h.getValue(),h.__checkbox=document.createElement("input"),h.__checkbox.setAttribute("type","checkbox"),k.default.bind(h.__checkbox,"change",g,!1),h.domElement.appendChild(h.__checkbox),h.updateDisplay(),h}return g(b,a),b.prototype.setValue=function(b){var c=a.prototype.setValue.call(this,b);return this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),this.__prev=this.getValue(),c},b.prototype.updateDisplay=function(){return!0===this.getValue()?(this.__checkbox.setAttribute("checked","checked"),this.__checkbox.checked=!0):this.__checkbox.checked=!1,a.prototype.updateDisplay.call(this)},b}(i.default);b.default=l},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}function e(a){if("0"===a||g.default.isUndefined(a))return 0;var b=a.match(j);return g.default.isNull(b)?0:parseFloat(b[1])}b.__esModule=!0;var f=c(5),g=d(f),h={HTMLEvents:["change"],MouseEvents:["click","mousemove","mousedown","mouseup","mouseover"],KeyboardEvents:["keydown"]},i={};g.default.each(h,function(a,b){g.default.each(a,function(a){i[a]=b})});var j=/(\d+(\.\d+)?)px/,k={makeSelectable:function(a,b){void 0!==a&&void 0!==a.style&&(a.onselectstart=b?function(){return!1}:function(){},a.style.MozUserSelect=b?"auto":"none",a.style.KhtmlUserSelect=b?"auto":"none",a.unselectable=b?"on":"off")},makeFullscreen:function(a,b,c){var d=c,e=b;g.default.isUndefined(e)&&(e=!0),g.default.isUndefined(d)&&(d=!0),a.style.position="absolute",e&&(a.style.left=0,a.style.right=0),d&&(a.style.top=0,a.style.bottom=0)},fakeEvent:function(a,b,c,d){var e=c||{},f=i[b];if(!f)throw new Error("Event type "+b+" not supported.");var h=document.createEvent(f);switch(f){case"MouseEvents":var j=e.x||e.clientX||0,k=e.y||e.clientY||0;h.initMouseEvent(b,e.bubbles||!1,e.cancelable||!0,window,e.clickCount||1,0,0,j,k,!1,!1,!1,!1,0,null);break;case"KeyboardEvents":var l=h.initKeyboardEvent||h.initKeyEvent;g.default.defaults(e,{cancelable:!0,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,keyCode:void 0,charCode:void 0}),l(b,e.bubbles||!1,e.cancelable,window,e.ctrlKey,e.altKey,e.shiftKey,e.metaKey,e.keyCode,e.charCode);break;default:h.initEvent(b,e.bubbles||!1,e.cancelable||!0)}g.default.defaults(h,d),a.dispatchEvent(h)},bind:function(a,b,c,d){var e=d||!1;return a.addEventListener?a.addEventListener(b,c,e):a.attachEvent&&a.attachEvent("on"+b,c),k},unbind:function(a,b,c,d){var e=d||!1;return a.removeEventListener?a.removeEventListener(b,c,e):a.detachEvent&&a.detachEvent("on"+b,c),k},addClass:function(a,b){if(void 0===a.className)a.className=b;else if(a.className!==b){var c=a.className.split(/ +/);-1===c.indexOf(b)&&(c.push(b),a.className=c.join(" ").replace(/^\s+/,"").replace(/\s+$/,""))}return k},removeClass:function(a,b){if(b)if(a.className===b)a.removeAttribute("class");else{var c=a.className.split(/ +/),d=c.indexOf(b);-1!==d&&(c.splice(d,1),a.className=c.join(" "))}else a.className=void 0;return k},hasClass:function(a,b){return new RegExp("(?:^|\\s+)"+b+"(?:\\s+|$)").test(a.className)||!1},getWidth:function(a){var b=getComputedStyle(a);return e(b["border-left-width"])+e(b["border-right-width"])+e(b["padding-left"])+e(b["padding-right"])+e(b.width)},getHeight:function(a){var b=getComputedStyle(a);return e(b["border-top-width"])+e(b["border-bottom-width"])+e(b["padding-top"])+e(b["padding-bottom"])+e(b.height)},getOffset:function(a){var b=a,c={left:0,top:0};if(b.offsetParent)do{c.left+=b.offsetLeft,c.top+=b.offsetTop,b=b.offsetParent}while(b);return c},isActive:function(a){return a===document.activeElement&&(a.type||a.href)}};b.default=k},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function f(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!=typeof b&&"function"!=typeof b?a:b}function g(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}b.__esModule=!0;var h=c(7),i=d(h),j=c(9),k=d(j),l=c(5),m=d(l),n=function(a){function b(c,d,g){e(this,b);var h=f(this,a.call(this,c,d)),i=g,j=h;return h.__select=document.createElement("select"),m.default.isArray(i)&&function(){var a={};m.default.each(i,function(b){a[b]=b}),i=a}(),m.default.each(i,function(a,b){var c=document.createElement("option");c.innerHTML=b,c.setAttribute("value",a),j.__select.appendChild(c)}),h.updateDisplay(),k.default.bind(h.__select,"change",function(){var a=this.options[this.selectedIndex].value;j.setValue(a)}),h.domElement.appendChild(h.__select),h}return g(b,a),b.prototype.setValue=function(b){var c=a.prototype.setValue.call(this,b);return this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),c},b.prototype.updateDisplay=function(){return k.default.isActive(this.__select)?this:(this.__select.value=this.getValue(),a.prototype.updateDisplay.call(this))},b}(i.default);b.default=n},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function f(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!=typeof b&&"function"!=typeof b?a:b}function g(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}b.__esModule=!0;var h=c(7),i=d(h),j=c(9),k=d(j),l=function(a){function b(c,d){function g(){j.setValue(j.__input.value)}function h(){j.__onFinishChange&&j.__onFinishChange.call(j,j.getValue())}e(this,b);var i=f(this,a.call(this,c,d)),j=i;return i.__input=document.createElement("input"),i.__input.setAttribute("type","text"),k.default.bind(i.__input,"keyup",g),k.default.bind(i.__input,"change",g),k.default.bind(i.__input,"blur",h),k.default.bind(i.__input,"keydown",function(a){13===a.keyCode&&this.blur()}),i.updateDisplay(),i.domElement.appendChild(i.__input),i}return g(b,a),b.prototype.updateDisplay=function(){return k.default.isActive(this.__input)||(this.__input.value=this.getValue()),a.prototype.updateDisplay.call(this)},b}(i.default);b.default=l},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function f(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!=typeof b&&"function"!=typeof b?a:b}function g(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}function h(a){var b=a.toString();return b.indexOf(".")>-1?b.length-b.indexOf(".")-1:0}b.__esModule=!0;var i=c(7),j=d(i),k=c(5),l=d(k),m=function(a){function b(c,d,g){e(this,b);var i=f(this,a.call(this,c,d)),j=g||{};return i.__min=j.min,i.__max=j.max,i.__step=j.step,l.default.isUndefined(i.__step)?0===i.initialValue?i.__impliedStep=1:i.__impliedStep=Math.pow(10,Math.floor(Math.log(Math.abs(i.initialValue))/Math.LN10))/10:i.__impliedStep=i.__step,i.__precision=h(i.__impliedStep),i}return g(b,a),b.prototype.setValue=function(b){var c=b;return void 0!==this.__min&&c<this.__min?c=this.__min:void 0!==this.__max&&c>this.__max&&(c=this.__max),void 0!==this.__step&&c%this.__step!=0&&(c=Math.round(c/this.__step)*this.__step),a.prototype.setValue.call(this,c)},b.prototype.min=function(a){return this.__min=a,this},b.prototype.max=function(a){return this.__max=a,this},b.prototype.step=function(a){return this.__step=a,this.__impliedStep=a,this.__precision=h(a),this},b}(j.default);b.default=m},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function f(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!=typeof b&&"function"!=typeof b?a:b}function g(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}function h(a,b){var c=Math.pow(10,b);return Math.round(a*c)/c}b.__esModule=!0;var i=c(12),j=d(i),k=c(9),l=d(k),m=c(5),n=d(m),o=function(a){function b(c,d,g){function h(){var a=parseFloat(q.__input.value);n.default.isNaN(a)||q.setValue(a)}function i(){q.__onFinishChange&&q.__onFinishChange.call(q,q.getValue())}function j(){i()}function k(a){var b=r-a.clientY;q.setValue(q.getValue()+b*q.__impliedStep),r=a.clientY}function m(){l.default.unbind(window,"mousemove",k),l.default.unbind(window,"mouseup",m),i()}function o(a){l.default.bind(window,"mousemove",k),l.default.bind(window,"mouseup",m),r=a.clientY}e(this,b);var p=f(this,a.call(this,c,d,g));p.__truncationSuspended=!1;var q=p,r=void 0;return p.__input=document.createElement("input"),p.__input.setAttribute("type","text"),l.default.bind(p.__input,"change",h),l.default.bind(p.__input,"blur",j),l.default.bind(p.__input,"mousedown",o),l.default.bind(p.__input,"keydown",function(a){13===a.keyCode&&(q.__truncationSuspended=!0,this.blur(),q.__truncationSuspended=!1,i())}),p.updateDisplay(),p.domElement.appendChild(p.__input),p}return g(b,a),b.prototype.updateDisplay=function(){return this.__input.value=this.__truncationSuspended?this.getValue():h(this.getValue(),this.__precision),a.prototype.updateDisplay.call(this)},b}(j.default);b.default=o},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function f(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!=typeof b&&"function"!=typeof b?a:b}function g(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}function h(a,b,c,d,e){return d+(a-b)/(c-b)*(e-d)}b.__esModule=!0;var i=c(12),j=d(i),k=c(9),l=d(k),m=function(a){function b(c,d,g,i,j){function k(a){document.activeElement.blur(),l.default.bind(window,"mousemove",m),l.default.bind(window,"mouseup",n),m(a)}function m(a){a.preventDefault();var b=p.__background.getBoundingClientRect();return p.setValue(h(a.clientX,b.left,b.right,p.__min,p.__max)),!1}function n(){l.default.unbind(window,"mousemove",m),l.default.unbind(window,"mouseup",n),p.__onFinishChange&&p.__onFinishChange.call(p,p.getValue())}e(this,b);var o=f(this,a.call(this,c,d,{min:g,max:i,step:j})),p=o;return o.__background=document.createElement("div"),o.__foreground=document.createElement("div"),l.default.bind(o.__background,"mousedown",k),l.default.addClass(o.__background,"slider"),l.default.addClass(o.__foreground,"slider-fg"),o.updateDisplay(),o.__background.appendChild(o.__foreground),o.domElement.appendChild(o.__background),o}return g(b,a),b.prototype.updateDisplay=function(){var b=(this.getValue()-this.__min)/(this.__max-this.__min);return this.__foreground.style.width=100*b+"%",a.prototype.updateDisplay.call(this)},b}(j.default);b.default=m},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function f(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!=typeof b&&"function"!=typeof b?a:b}function g(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}b.__esModule=!0;var h=c(7),i=d(h),j=c(9),k=d(j),l=function(a){function b(c,d,g){e(this,b);var h=f(this,a.call(this,c,d)),i=h;return h.__button=document.createElement("div"),h.__button.innerHTML=void 0===g?"Fire":g,k.default.bind(h.__button,"click",function(a){return a.preventDefault(),i.fire(),!1}),k.default.addClass(h.__button,"button"),h.domElement.appendChild(h.__button),h}return g(b,a),b.prototype.fire=function(){this.__onChange&&this.__onChange.call(this),this.getValue().call(this.object),this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue())},b}(i.default);b.default=l},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function f(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!=typeof b&&"function"!=typeof b?a:b}function g(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}function h(a,b,c,d){a.style.background="",s.default.each(u,function(e){a.style.cssText+="background: "+e+"linear-gradient("+b+", "+c+" 0%, "+d+" 100%); "})}function i(a){a.style.background="",a.style.cssText+="background: -moz-linear-gradient(top,  #ff0000 0%, #ff00ff 17%, #0000ff 34%, #00ffff 50%, #00ff00 67%, #ffff00 84%, #ff0000 100%);",a.style.cssText+="background: -webkit-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",a.style.cssText+="background: -o-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",a.style.cssText+="background: -ms-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",a.style.cssText+="background: linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);"}b.__esModule=!0;var j=c(7),k=d(j),l=c(9),m=d(l),n=c(2),o=d(n),p=c(3),q=d(p),r=c(5),s=d(r),t=function(a){function b(c,d){function g(a){p(a),m.default.bind(window,"mousemove",p),m.default.bind(window,"mouseup",j)}function j(){m.default.unbind(window,"mousemove",p),m.default.unbind(window,"mouseup",j),n()}function k(){var a=(0,q.default)(this.value);!1!==a?(u.__color.__state=a,u.setValue(u.__color.toOriginal())):this.value=u.__color.toString()}function l(){m.default.unbind(window,"mousemove",r),m.default.unbind(window,"mouseup",l),n()}function n(){u.__onFinishChange&&u.__onFinishChange.call(u,u.__color.toOriginal())}function p(a){a.preventDefault();var b=u.__saturation_field.getBoundingClientRect(),c=(a.clientX-b.left)/(b.right-b.left),d=1-(a.clientY-b.top)/(b.bottom-b.top);return d>1?d=1:d<0&&(d=0),c>1?c=1:c<0&&(c=0),u.__color.v=d,u.__color.s=c,u.setValue(u.__color.toOriginal()),!1}function r(a){a.preventDefault();var b=u.__hue_field.getBoundingClientRect(),c=1-(a.clientY-b.top)/(b.bottom-b.top);return c>1?c=1:c<0&&(c=0),u.__color.h=360*c,u.setValue(u.__color.toOriginal()),!1}e(this,b);var t=f(this,a.call(this,c,d));t.__color=new o.default(t.getValue()),t.__temp=new o.default(0);var u=t;t.domElement=document.createElement("div"),m.default.makeSelectable(t.domElement,!1),t.__selector=document.createElement("div"),t.__selector.className="selector",t.__saturation_field=document.createElement("div"),t.__saturation_field.className="saturation-field",t.__field_knob=document.createElement("div"),t.__field_knob.className="field-knob",t.__field_knob_border="2px solid ",t.__hue_knob=document.createElement("div"),t.__hue_knob.className="hue-knob",t.__hue_field=document.createElement("div"),t.__hue_field.className="hue-field",t.__input=document.createElement("input"),t.__input.type="text",t.__input_textShadow="0 1px 1px ",m.default.bind(t.__input,"keydown",function(a){13===a.keyCode&&k.call(this)}),m.default.bind(t.__input,"blur",k),m.default.bind(t.__selector,"mousedown",function(){m.default.addClass(this,"drag").bind(window,"mouseup",function(){m.default.removeClass(u.__selector,"drag")})});var v=document.createElement("div");return s.default.extend(t.__selector.style,{width:"122px",height:"102px",padding:"3px",backgroundColor:"#222",boxShadow:"0px 1px 3px rgba(0,0,0,0.3)"}),s.default.extend(t.__field_knob.style,{position:"absolute",width:"12px",height:"12px",border:t.__field_knob_border+(t.__color.v<.5?"#fff":"#000"),boxShadow:"0px 1px 3px rgba(0,0,0,0.5)",borderRadius:"12px",zIndex:1}),s.default.extend(t.__hue_knob.style,{position:"absolute",width:"15px",height:"2px",borderRight:"4px solid #fff",zIndex:1}),s.default.extend(t.__saturation_field.style,{width:"100px",height:"100px",border:"1px solid #555",marginRight:"3px",display:"inline-block",cursor:"pointer"}),s.default.extend(v.style,{width:"100%",height:"100%",background:"none"}),h(v,"top","rgba(0,0,0,0)","#000"),s.default.extend(t.__hue_field.style,{width:"15px",height:"100px",border:"1px solid #555",cursor:"ns-resize",position:"absolute",top:"3px",right:"3px"}),i(t.__hue_field),s.default.extend(t.__input.style,{outline:"none",textAlign:"center",color:"#fff",border:0,fontWeight:"bold",textShadow:t.__input_textShadow+"rgba(0,0,0,0.7)"}),m.default.bind(t.__saturation_field,"mousedown",g),m.default.bind(t.__field_knob,"mousedown",g),m.default.bind(t.__hue_field,"mousedown",function(a){r(a),m.default.bind(window,"mousemove",r),m.default.bind(window,"mouseup",l)}),t.__saturation_field.appendChild(v),t.__selector.appendChild(t.__field_knob),t.__selector.appendChild(t.__saturation_field),t.__selector.appendChild(t.__hue_field),t.__hue_field.appendChild(t.__hue_knob),t.domElement.appendChild(t.__input),t.domElement.appendChild(t.__selector),t.updateDisplay(),t}return g(b,a),b.prototype.updateDisplay=function(){var a=(0,q.default)(this.getValue());if(!1!==a){var b=!1;s.default.each(o.default.COMPONENTS,function(c){if(!s.default.isUndefined(a[c])&&!s.default.isUndefined(this.__color.__state[c])&&a[c]!==this.__color.__state[c])return b=!0,{}},this),b&&s.default.extend(this.__color.__state,a)}s.default.extend(this.__temp.__state,this.__color.__state),this.__temp.a=1;var c=this.__color.v<.5||this.__color.s>.5?255:0,d=255-c;s.default.extend(this.__field_knob.style,{marginLeft:100*this.__color.s-7+"px",marginTop:100*(1-this.__color.v)-7+"px",backgroundColor:this.__temp.toHexString(),border:this.__field_knob_border+"rgb("+c+","+c+","+c+")"}),this.__hue_knob.style.marginTop=100*(1-this.__color.h/360)+"px",this.__temp.s=1,this.__temp.v=1,h(this.__saturation_field,"left","#fff",this.__temp.toHexString()),this.__input.value=this.__color.toString(),s.default.extend(this.__input.style,{backgroundColor:this.__color.toHexString(),color:"rgb("+c+","+c+","+c+")",textShadow:this.__input_textShadow+"rgba("+d+","+d+","+d+",.7)"})},b}(k.default),u=["-moz-","-o-","-webkit-","-ms-",""];b.default=t},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}function e(a,b,c){var d=document.createElement("li");return b&&d.appendChild(b),c?a.__ul.insertBefore(d,c):a.__ul.appendChild(d),a.onResize(),d}function f(a,b){var c=a.__preset_select[a.__preset_select.selectedIndex];c.innerHTML=b?c.value+"*":c.value}function g(a,b,c){if(c.__li=b,c.__gui=a,S.default.extend(c,{options:function(b){if(arguments.length>1){var d=c.__li.nextElementSibling;return c.remove(),i(a,c.object,c.property,{before:d,factoryArgs:[S.default.toArray(arguments)]})}if(S.default.isArray(b)||S.default.isObject(b)){var e=c.__li.nextElementSibling;return c.remove(),i(a,c.object,c.property,{before:e,factoryArgs:[b]})}},name:function(a){return c.__li.firstElementChild.firstElementChild.innerHTML=a,c},listen:function(){return c.__gui.listen(c),c},remove:function(){return c.__gui.remove(c),c}}),c instanceof I.default)!function(){var a=new G.default(c.object,c.property,{min:c.__min,max:c.__max,step:c.__step});S.default.each(["updateDisplay","onChange","onFinishChange","step"],function(b){var d=c[b],e=a[b];c[b]=a[b]=function(){var b=Array.prototype.slice.call(arguments);return e.apply(a,b),d.apply(c,b)}}),Q.default.addClass(b,"has-slider"),c.domElement.insertBefore(a.domElement,c.domElement.firstElementChild)}();else if(c instanceof G.default){var d=function(b){if(S.default.isNumber(c.__min)&&S.default.isNumber(c.__max)){var d=c.__li.firstElementChild.firstElementChild.innerHTML,e=c.__gui.__listening.indexOf(c)>-1;c.remove();var f=i(a,c.object,c.property,{before:c.__li.nextElementSibling,factoryArgs:[c.__min,c.__max,c.__step]});return f.name(d),e&&f.listen(),f}return b};c.min=S.default.compose(d,c.min),c.max=S.default.compose(d,c.max)}else c instanceof C.default?(Q.default.bind(b,"click",function(){Q.default.fakeEvent(c.__checkbox,"click")}),Q.default.bind(c.__checkbox,"click",function(a){a.stopPropagation()})):c instanceof E.default?(Q.default.bind(b,"click",function(){Q.default.fakeEvent(c.__button,"click")}),Q.default.bind(b,"mouseover",function(){Q.default.addClass(c.__button,"hover")}),Q.default.bind(b,"mouseout",function(){Q.default.removeClass(c.__button,"hover")})):c instanceof K.default&&(Q.default.addClass(b,"color"),c.updateDisplay=S.default.compose(function(a){return b.style.borderLeftColor=c.__color.toString(),a},c.updateDisplay),c.updateDisplay());c.setValue=S.default.compose(function(b){return a.getRoot().__preset_select&&c.isModified()&&f(a.getRoot(),!0),b},c.setValue)}function h(a,b){var c=a.getRoot(),d=c.__rememberedObjects.indexOf(b.object);if(-1!==d){var e=c.__rememberedObjectIndecesToControllers[d];if(void 0===e&&(e={},c.__rememberedObjectIndecesToControllers[d]=e),e[b.property]=b,c.load&&c.load.remembered){var f=c.load.remembered,g=void 0;if(f[a.preset])g=f[a.preset];else{if(!f[Y])return;g=f[Y]}if(g[d]&&void 0!==g[d][b.property]){var h=g[d][b.property];b.initialValue=h,b.setValue(h)}}}}function i(a,b,c,d){if(void 0===b[c])throw new Error('Object "'+b+'" has no property "'+c+'"');var f=void 0;if(d.color)f=new K.default(b,c);else{var i=[b,c].concat(d.factoryArgs);f=y.default.apply(a,i)}d.before instanceof A.default&&(d.before=d.before.__li),h(a,f),Q.default.addClass(f.domElement,"c");var j=document.createElement("span");Q.default.addClass(j,"property-name"),j.innerHTML=f.property;var k=document.createElement("div");k.appendChild(j),k.appendChild(f.domElement);var l=e(a,k,d.before);return Q.default.addClass(l,da.CLASS_CONTROLLER_ROW),f instanceof K.default?Q.default.addClass(l,"color"):Q.default.addClass(l,s(f.getValue())),g(a,l,f),a.__controllers.push(f),f}function j(a,b){return document.location.href+"."+b}function k(a,b,c){var d=document.createElement("option");d.innerHTML=b,d.value=b,a.__preset_select.appendChild(d),c&&(a.__preset_select.selectedIndex=a.__preset_select.length-1)}function l(a,b){b.style.display=a.useLocalStorage?"block":"none"}function m(a){var b=a.__save_row=document.createElement("li");Q.default.addClass(a.domElement,"has-save"),a.__ul.insertBefore(b,a.__ul.firstChild),Q.default.addClass(b,"save-row");var c=document.createElement("span");c.innerHTML="&nbsp;",Q.default.addClass(c,"button gears");var d=document.createElement("span");d.innerHTML="Save",Q.default.addClass(d,"button"),Q.default.addClass(d,"save");var e=document.createElement("span");e.innerHTML="New",Q.default.addClass(e,"button"),Q.default.addClass(e,"save-as");var f=document.createElement("span");f.innerHTML="Revert",Q.default.addClass(f,"button"),Q.default.addClass(f,"revert");var g=a.__preset_select=document.createElement("select");a.load&&a.load.remembered?S.default.each(a.load.remembered,function(b,c){k(a,c,c===a.preset)}):k(a,Y,!1),Q.default.bind(g,"change",function(){for(var b=0;b<a.__preset_select.length;b++)a.__preset_select[b].innerHTML=a.__preset_select[b].value;a.preset=this.value}),b.appendChild(g),b.appendChild(c),b.appendChild(d),b.appendChild(e),b.appendChild(f),Z&&function(){var b=document.getElementById("dg-local-explain"),c=document.getElementById("dg-local-storage");document.getElementById("dg-save-locally").style.display="block","true"===localStorage.getItem(j(a,"isLocal"))&&c.setAttribute("checked","checked"),l(a,b),Q.default.bind(c,"change",function(){a.useLocalStorage=!a.useLocalStorage,l(a,b)})}();var h=document.getElementById("dg-new-constructor");Q.default.bind(h,"keydown",function(a){!a.metaKey||67!==a.which&&67!==a.keyCode||$.hide()}),Q.default.bind(c,"click",function(){h.innerHTML=JSON.stringify(a.getSaveObject(),void 0,2),$.show(),h.focus(),h.select()}),Q.default.bind(d,"click",function(){a.save()}),Q.default.bind(e,"click",function(){var b=prompt("Enter a new preset name.");b&&a.saveAs(b)}),Q.default.bind(f,"click",function(){a.revert()})}function n(a){function b(b){return b.preventDefault(),a.width+=e-b.clientX,a.onResize(),e=b.clientX,!1}function c(){Q.default.removeClass(a.__closeButton,da.CLASS_DRAG),Q.default.unbind(window,"mousemove",b),Q.default.unbind(window,"mouseup",c)}function d(d){return d.preventDefault(),e=d.clientX,Q.default.addClass(a.__closeButton,da.CLASS_DRAG),Q.default.bind(window,"mousemove",b),Q.default.bind(window,"mouseup",c),!1}var e=void 0;a.__resize_handle=document.createElement("div"),S.default.extend(a.__resize_handle.style,{width:"6px",marginLeft:"-3px",height:"200px",cursor:"ew-resize",position:"absolute"}),Q.default.bind(a.__resize_handle,"mousedown",d),Q.default.bind(a.__closeButton,"mousedown",d),a.domElement.insertBefore(a.__resize_handle,a.domElement.firstElementChild)}function o(a,b){a.domElement.style.width=b+"px",a.__save_row&&a.autoPlace&&(a.__save_row.style.width=b+"px"),a.__closeButton&&(a.__closeButton.style.width=b+"px")}function p(a,b){var c={};return S.default.each(a.__rememberedObjects,function(d,e){var f={},g=a.__rememberedObjectIndecesToControllers[e];S.default.each(g,function(a,c){f[c]=b?a.initialValue:a.getValue()}),c[e]=f}),c}function q(a){for(var b=0;b<a.__preset_select.length;b++)a.__preset_select[b].value===a.preset&&(a.__preset_select.selectedIndex=b)}function r(a){0!==a.length&&M.default.call(window,function(){r(a)}),S.default.each(a,function(a){a.updateDisplay()})}var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol?"symbol":typeof a},t=c(18),u=d(t),v=c(19),w=d(v),x=c(20),y=d(x),z=c(7),A=d(z),B=c(8),C=d(B),D=c(15),E=d(D),F=c(13),G=d(F),H=c(14),I=d(H),J=c(16),K=d(J),L=c(21),M=d(L),N=c(22),O=d(N),P=c(9),Q=d(P),R=c(5),S=d(R),T=c(23),U=d(T);u.default.inject(U.default);var V="dg",W=72,X=20,Y="Default",Z=function(){try{return"localStorage"in window&&null!==window.localStorage}catch(a){return!1}}(),$=void 0,_=!0,aa=void 0,ba=!1,ca=[],da=function a(b){function c(){var a=d.getRoot();a.width+=1,S.default.defer(function(){a.width-=1})}var d=this,f=b||{};this.domElement=document.createElement("div"),this.__ul=document.createElement("ul"),this.domElement.appendChild(this.__ul),Q.default.addClass(this.domElement,V),this.__folders={},this.__controllers=[],this.__rememberedObjects=[],this.__rememberedObjectIndecesToControllers=[],this.__listening=[],f=S.default.defaults(f,{autoPlace:!0,width:a.DEFAULT_WIDTH}),f=S.default.defaults(f,{resizable:f.autoPlace,hideable:f.autoPlace}),S.default.isUndefined(f.load)?f.load={preset:Y}:f.preset&&(f.load.preset=f.preset),S.default.isUndefined(f.parent)&&f.hideable&&ca.push(this),f.resizable=S.default.isUndefined(f.parent)&&f.resizable,f.autoPlace&&S.default.isUndefined(f.scrollable)&&(f.scrollable=!0);var g=Z&&"true"===localStorage.getItem(j(this,"isLocal")),h=void 0;if(Object.defineProperties(this,{parent:{get:function(){return f.parent}},scrollable:{get:function(){return f.scrollable}},autoPlace:{get:function(){return f.autoPlace}},preset:{get:function(){return d.parent?d.getRoot().preset:f.load.preset},set:function(a){d.parent?d.getRoot().preset=a:f.load.preset=a,q(this),d.revert()}},width:{get:function(){return f.width},set:function(a){f.width=a,o(d,a)}},name:{get:function(){return f.name},set:function(a){f.name=a,titleRowName&&(titleRowName.innerHTML=f.name)}},closed:{get:function(){return f.closed},set:function(b){f.closed=b,f.closed?Q.default.addClass(d.__ul,a.CLASS_CLOSED):Q.default.removeClass(d.__ul,a.CLASS_CLOSED),this.onResize(),d.__closeButton&&(d.__closeButton.innerHTML=b?a.TEXT_OPEN:a.TEXT_CLOSED)}},load:{get:function(){return f.load}},useLocalStorage:{get:function(){return g},set:function(a){Z&&(g=a,a?Q.default.bind(window,"unload",h):Q.default.unbind(window,"unload",h),localStorage.setItem(j(d,"isLocal"),a))}}}),S.default.isUndefined(f.parent)){if(f.closed=!1,Q.default.addClass(this.domElement,a.CLASS_MAIN),Q.default.makeSelectable(this.domElement,!1),Z&&g){d.useLocalStorage=!0;var i=localStorage.getItem(j(this,"gui"));i&&(f.load=JSON.parse(i))}this.__closeButton=document.createElement("div"),this.__closeButton.innerHTML=a.TEXT_CLOSED,Q.default.addClass(this.__closeButton,a.CLASS_CLOSE_BUTTON),this.domElement.appendChild(this.__closeButton),Q.default.bind(this.__closeButton,"click",function(){d.closed=!d.closed})}else{void 0===f.closed&&(f.closed=!0);var k=document.createTextNode(f.name);Q.default.addClass(k,"controller-name");var l=e(d,k),m=function(a){return a.preventDefault(),d.closed=!d.closed,!1};Q.default.addClass(this.__ul,a.CLASS_CLOSED),Q.default.addClass(l,"title"),Q.default.bind(l,"click",m),f.closed||(this.closed=!1)}f.autoPlace&&(S.default.isUndefined(f.parent)&&(_&&(aa=document.createElement("div"),Q.default.addClass(aa,V),Q.default.addClass(aa,a.CLASS_AUTO_PLACE_CONTAINER),document.body.appendChild(aa),_=!1),aa.appendChild(this.domElement),Q.default.addClass(this.domElement,a.CLASS_AUTO_PLACE)),this.parent||o(d,f.width)),this.__resizeHandler=function(){d.onResizeDebounced()},Q.default.bind(window,"resize",this.__resizeHandler),Q.default.bind(this.__ul,"webkitTransitionEnd",this.__resizeHandler),Q.default.bind(this.__ul,"transitionend",this.__resizeHandler),Q.default.bind(this.__ul,"oTransitionEnd",this.__resizeHandler),this.onResize(),f.resizable&&n(this),h=function(){Z&&"true"===localStorage.getItem(j(d,"isLocal"))&&localStorage.setItem(j(d,"gui"),JSON.stringify(d.getSaveObject()))},this.saveToLocalStorageIfPossible=h,f.parent||c()};da.toggleHide=function(){ba=!ba,S.default.each(ca,function(a){a.domElement.style.display=ba?"none":""})},da.CLASS_AUTO_PLACE="a",da.CLASS_AUTO_PLACE_CONTAINER="ac",da.CLASS_MAIN="main",da.CLASS_CONTROLLER_ROW="cr",da.CLASS_TOO_TALL="taller-than-window",da.CLASS_CLOSED="closed",da.CLASS_CLOSE_BUTTON="close-button",da.CLASS_DRAG="drag",da.DEFAULT_WIDTH=245,da.TEXT_CLOSED="Close Controls",da.TEXT_OPEN="Open Controls",da._keydownHandler=function(a){"text"===document.activeElement.type||a.which!==W&&a.keyCode!==W||da.toggleHide()},Q.default.bind(window,"keydown",da._keydownHandler,!1),S.default.extend(da.prototype,{add:function(a,b){return i(this,a,b,{factoryArgs:Array.prototype.slice.call(arguments,2)})},addColor:function(a,b){return i(this,a,b,{color:!0})},remove:function(a){this.__ul.removeChild(a.__li),this.__controllers.splice(this.__controllers.indexOf(a),1);var b=this;S.default.defer(function(){b.onResize()})},destroy:function(){this.autoPlace&&aa.removeChild(this.domElement),Q.default.unbind(window,"keydown",da._keydownHandler,!1),Q.default.unbind(window,"resize",this.__resizeHandler),this.saveToLocalStorageIfPossible&&Q.default.unbind(window,"unload",this.saveToLocalStorageIfPossible)},addFolder:function(a){if(void 0!==this.__folders[a])throw new Error('You already have a folder in this GUI by the name "'+a+'"');var b={name:a,parent:this};b.autoPlace=this.autoPlace,this.load&&this.load.folders&&this.load.folders[a]&&(b.closed=this.load.folders[a].closed,b.load=this.load.folders[a]);var c=new da(b);this.__folders[a]=c;var d=e(this,c.domElement);return Q.default.addClass(d,"folder"),c},open:function(){this.closed=!1},close:function(){this.closed=!0},onResize:function(){var a=this.getRoot();if(a.scrollable){var b=Q.default.getOffset(a.__ul).top,c=0;S.default.each(a.__ul.childNodes,function(b){a.autoPlace&&b===a.__save_row||(c+=Q.default.getHeight(b))}),window.innerHeight-b-X<c?(Q.default.addClass(a.domElement,da.CLASS_TOO_TALL),a.__ul.style.height=window.innerHeight-b-X+"px"):(Q.default.removeClass(a.domElement,da.CLASS_TOO_TALL),a.__ul.style.height="auto")}a.__resize_handle&&S.default.defer(function(){a.__resize_handle.style.height=a.__ul.offsetHeight+"px"}),a.__closeButton&&(a.__closeButton.style.width=a.width+"px")},onResizeDebounced:S.default.debounce(function(){this.onResize()},200),remember:function(){if(S.default.isUndefined($)&&($=new O.default,$.domElement.innerHTML=w.default),this.parent)throw new Error("You can only call remember on a top level GUI.");var a=this;S.default.each(Array.prototype.slice.call(arguments),function(b){0===a.__rememberedObjects.length&&m(a),-1===a.__rememberedObjects.indexOf(b)&&a.__rememberedObjects.push(b)}),this.autoPlace&&o(this,this.width)},getRoot:function(){for(var a=this;a.parent;)a=a.parent;return a},getSaveObject:function(){var a=this.load;return a.closed=this.closed,this.__rememberedObjects.length>0&&(a.preset=this.preset,a.remembered||(a.remembered={}),a.remembered[this.preset]=p(this)),a.folders={},S.default.each(this.__folders,function(b,c){a.folders[c]=b.getSaveObject()}),a},save:function(){this.load.remembered||(this.load.remembered={}),this.load.remembered[this.preset]=p(this),f(this,!1),this.saveToLocalStorageIfPossible()},saveAs:function(a){this.load.remembered||(this.load.remembered={},this.load.remembered[Y]=p(this,!0)),this.load.remembered[a]=p(this),this.preset=a,k(this,a,!0),this.saveToLocalStorageIfPossible()},revert:function(a){S.default.each(this.__controllers,function(b){this.getRoot().load.remembered?h(a||this.getRoot(),b):b.setValue(b.initialValue),b.__onFinishChange&&b.__onFinishChange.call(b,b.getValue())},this),S.default.each(this.__folders,function(a){a.revert(a)}),a||f(this.getRoot(),!1)},listen:function(a){var b=0===this.__listening.length;this.__listening.push(a),b&&r(this.__listening)},updateDisplay:function(){S.default.each(this.__controllers,function(a){a.updateDisplay()}),S.default.each(this.__folders,function(a){a.updateDisplay()})}}),a.exports=da},function(a,b){"use strict";a.exports={load:function(a,b){var c=b||document,d=c.createElement("link");d.type="text/css",d.rel="stylesheet",d.href=a,c.getElementsByTagName("head")[0].appendChild(d)},inject:function(a,b){var c=b||document,d=document.createElement("style");d.type="text/css",d.innerHTML=a;var e=c.getElementsByTagName("head")[0];try{e.appendChild(d)}catch(a){}}}},function(a,b){a.exports="<div id=dg-save class=\"dg dialogue\"> Here's the new load parameter for your <code>GUI</code>'s constructor: <textarea id=dg-new-constructor></textarea> <div id=dg-save-locally> <input id=dg-local-storage type=checkbox /> Automatically save values to <code>localStorage</code> on exit. <div id=dg-local-explain>The values saved to <code>localStorage</code> will override those passed to <code>dat.GUI</code>'s constructor. This makes it easier to work incrementally, but <code>localStorage</code> is fragile, and your friends may not see the same values you do. </div> </div> </div>"},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}b.__esModule=!0;var e=c(10),f=d(e),g=c(13),h=d(g),i=c(14),j=d(i),k=c(11),l=d(k),m=c(15),n=d(m),o=c(8),p=d(o),q=c(5),r=d(q),s=function(a,b){var c=a[b];return r.default.isArray(arguments[2])||r.default.isObject(arguments[2])?new f.default(a,b,arguments[2]):r.default.isNumber(c)?r.default.isNumber(arguments[2])&&r.default.isNumber(arguments[3])?r.default.isNumber(arguments[4])?new j.default(a,b,arguments[2],arguments[3],arguments[4]):new j.default(a,b,arguments[2],arguments[3]):r.default.isNumber(arguments[4])?new h.default(a,b,{min:arguments[2],max:arguments[3],step:arguments[4]}):new h.default(a,b,{min:arguments[2],max:arguments[3]}):r.default.isString(c)?new l.default(a,b):r.default.isFunction(c)?new n.default(a,b,""):r.default.isBoolean(c)?new p.default(a,b):null};b.default=s},function(a,b){"use strict";function c(a){setTimeout(a,1e3/60)}b.__esModule=!0,b.default=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||c},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}b.__esModule=!0;var f=c(9),g=d(f),h=c(5),i=d(h),j=function(){function a(){e(this,a),this.backgroundElement=document.createElement("div"),i.default.extend(this.backgroundElement.style,{backgroundColor:"rgba(0,0,0,0.8)",top:0,left:0,display:"none",zIndex:"1000",opacity:0,WebkitTransition:"opacity 0.2s linear",transition:"opacity 0.2s linear"}),g.default.makeFullscreen(this.backgroundElement),this.backgroundElement.style.position="fixed",this.domElement=document.createElement("div"),i.default.extend(this.domElement.style,{position:"fixed",display:"none",zIndex:"1001",opacity:0,WebkitTransition:"-webkit-transform 0.2s ease-out, opacity 0.2s linear",transition:"transform 0.2s ease-out, opacity 0.2s linear"}),document.body.appendChild(this.backgroundElement),document.body.appendChild(this.domElement);var b=this;g.default.bind(this.backgroundElement,"click",function(){b.hide()})}return a.prototype.show=function(){var a=this;this.backgroundElement.style.display="block",this.domElement.style.display="block",this.domElement.style.opacity=0,this.domElement.style.webkitTransform="scale(1.1)",this.layout(),i.default.defer(function(){a.backgroundElement.style.opacity=1,a.domElement.style.opacity=1,a.domElement.style.webkitTransform="scale(1)"})},a.prototype.hide=function(){var b=this,a=function a(){b.domElement.style.display="none",b.backgroundElement.style.display="none",g.default.unbind(b.domElement,"webkitTransitionEnd",a),g.default.unbind(b.domElement,"transitionend",a),g.default.unbind(b.domElement,"oTransitionEnd",a)};g.default.bind(this.domElement,"webkitTransitionEnd",a),g.default.bind(this.domElement,"transitionend",a),g.default.bind(this.domElement,"oTransitionEnd",a),this.backgroundElement.style.opacity=0,this.domElement.style.opacity=0,this.domElement.style.webkitTransform="scale(1.1)"},a.prototype.layout=function(){this.domElement.style.left=window.innerWidth/2-g.default.getWidth(this.domElement)/2+"px",this.domElement.style.top=window.innerHeight/2-g.default.getHeight(this.domElement)/2+"px"},a}();b.default=j},function(a,b,c){b=a.exports=c(24)(),b.push([a.id,".dg ul{list-style:none;margin:0;padding:0;width:100%;clear:both}.dg.ac{position:fixed;top:0;left:0;right:0;height:0;z-index:0}.dg:not(.ac) .main{overflow:hidden}.dg.main{-webkit-transition:opacity .1s linear;transition:opacity .1s linear}.dg.main.taller-than-window{overflow-y:auto}.dg.main.taller-than-window .close-button{opacity:1;margin-top:-1px;border-top:1px solid #2c2c2c}.dg.main ul.closed .close-button{opacity:1!important}.dg.main .close-button.drag,.dg.main:hover .close-button{opacity:1}.dg.main .close-button{-webkit-transition:opacity .1s linear;transition:opacity .1s linear;border:0;position:absolute;line-height:19px;height:20px;cursor:pointer;text-align:center;background-color:#000}.dg.main .close-button:hover{background-color:#111}.dg.a{float:right;margin-right:15px;overflow-x:hidden}.dg.a.has-save>ul{margin-top:27px}.dg.a.has-save>ul.closed{margin-top:0}.dg.a .save-row{position:fixed;top:0;z-index:1002}.dg li{-webkit-transition:height .1s ease-out;transition:height .1s ease-out}.dg li:not(.folder){cursor:auto;height:27px;line-height:27px;overflow:hidden;padding:0 4px 0 5px}.dg li.folder{padding:0;border-left:4px solid transparent}.dg li.title{cursor:pointer;margin-left:-4px}.dg .closed li:not(.title),.dg .closed ul li,.dg .closed ul li>*{height:0;overflow:hidden;border:0}.dg .cr{clear:both;padding-left:3px;height:27px}.dg .property-name{cursor:default;float:left;clear:left;width:40%;overflow:hidden;text-overflow:ellipsis}.dg .c{float:left;width:60%}.dg .c input[type=text]{border:0;margin-top:4px;padding:3px;width:100%;float:right}.dg .has-slider input[type=text]{width:30%;margin-left:0}.dg .slider{float:left;width:66%;margin-left:-5px;margin-right:0;height:19px;margin-top:4px}.dg .slider-fg{height:100%}.dg .c input[type=checkbox]{margin-top:9px}.dg .c select{margin-top:5px}.dg .cr.boolean,.dg .cr.boolean *,.dg .cr.function,.dg .cr.function *,.dg .cr.function .property-name{cursor:pointer}.dg .selector{display:none;position:absolute;margin-left:-9px;margin-top:23px;z-index:10}.dg .c:hover .selector,.dg .selector.drag{display:block}.dg li.save-row{padding:0}.dg li.save-row .button{display:inline-block;padding:0 6px}.dg.dialogue{background-color:#222;width:460px;padding:15px;font-size:13px;line-height:15px}#dg-new-constructor{padding:10px;color:#222;font-family:Monaco,monospace;font-size:10px;border:0;resize:none;box-shadow:inset 1px 1px 1px #888;word-wrap:break-word;margin:12px 0;display:block;width:440px;overflow-y:scroll;height:100px;position:relative}#dg-local-explain{display:none;font-size:11px;line-height:17px;border-radius:3px;background-color:#333;padding:8px;margin-top:10px}#dg-local-explain code{font-size:10px}#dat-gui-save-locally{display:none}.dg{color:#eee;font:11px Lucida Grande,sans-serif;text-shadow:0 -1px 0 #111}.dg.main::-webkit-scrollbar{width:5px;background:#1a1a1a}.dg.main::-webkit-scrollbar-corner{height:0;display:none}.dg.main::-webkit-scrollbar-thumb{border-radius:5px;background:#676767}.dg li:not(.folder){background:#1a1a1a;border-bottom:1px solid #2c2c2c}.dg li.save-row{line-height:25px;background:#dad5cb;border:0}.dg li.save-row select{margin-left:5px;width:108px}.dg li.save-row .button{margin-left:5px;margin-top:1px;border-radius:2px;font-size:9px;line-height:7px;padding:4px 4px 5px;background:#c5bdad;color:#fff;text-shadow:0 1px 0 #b0a58f;box-shadow:0 -1px 0 #b0a58f;cursor:pointer}.dg li.save-row .button.gears{background:#c5bdad url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAANCAYAAAB/9ZQ7AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAQJJREFUeNpiYKAU/P//PwGIC/ApCABiBSAW+I8AClAcgKxQ4T9hoMAEUrxx2QSGN6+egDX+/vWT4e7N82AMYoPAx/evwWoYoSYbACX2s7KxCxzcsezDh3evFoDEBYTEEqycggWAzA9AuUSQQgeYPa9fPv6/YWm/Acx5IPb7ty/fw+QZblw67vDs8R0YHyQhgObx+yAJkBqmG5dPPDh1aPOGR/eugW0G4vlIoTIfyFcA+QekhhHJhPdQxbiAIguMBTQZrPD7108M6roWYDFQiIAAv6Aow/1bFwXgis+f2LUAynwoIaNcz8XNx3Dl7MEJUDGQpx9gtQ8YCueB+D26OECAAQDadt7e46D42QAAAABJRU5ErkJggg==) 2px 1px no-repeat;height:7px;width:8px}.dg li.save-row .button:hover{background-color:#bab19e;box-shadow:0 -1px 0 #b0a58f}.dg li.folder{border-bottom:0}.dg li.title{padding-left:16px;background:#000 url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlI+hKgFxoCgAOw==) 6px 10px no-repeat;cursor:pointer;border-bottom:1px solid hsla(0,0%,100%,.2)}.dg .closed li.title{background-image:url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlGIWqMCbWAEAOw==)}.dg .cr.boolean{border-left:3px solid #806787}.dg .cr.color{border-left:3px solid}.dg .cr.function{border-left:3px solid #e61d5f}.dg .cr.number{border-left:3px solid #2fa1d6}.dg .cr.number input[type=text]{color:#2fa1d6}.dg .cr.string{border-left:3px solid #1ed36f}.dg .cr.string input[type=text]{color:#1ed36f}.dg .cr.boolean:hover,.dg .cr.function:hover{background:#111}.dg .c input[type=text]{background:#303030;outline:none}.dg .c input[type=text]:hover{background:#3c3c3c}.dg .c input[type=text]:focus{background:#494949;color:#fff}.dg .c .slider{background:#303030;cursor:ew-resize}.dg .c .slider-fg{background:#2fa1d6;max-width:100%}.dg .c .slider:hover{background:#3c3c3c}.dg .c .slider:hover .slider-fg{background:#44abda}",""])},function(a,b){a.exports=function(){var a=[];return a.toString=function(){for(var a=[],b=0;b<this.length;b++){var c=this[b];c[2]?a.push("@media "+c[2]+"{"+c[1]+"}"):a.push(c[1])}return a.join("")},a.i=function(b,c){"string"==typeof b&&(b=[[null,b,""]]);for(var d={},e=0;e<this.length;e++){var f=this[e][0];"number"==typeof f&&(d[f]=!0)}for(e=0;e<b.length;e++){var g=b[e];"number"==typeof g[0]&&d[g[0]]||(c&&!g[2]?g[2]=c:c&&(g[2]="("+g[2]+") and ("+c+")"),a.push(g))}},a}}])});var Detector={canvas:!!window.CanvasRenderingContext2D,webgl:function(){try{var a=document.createElement("canvas");return!(!window.WebGLRenderingContext||!a.getContext("webgl")&&!a.getContext("experimental-webgl"))}catch(a){return!1}}(),workers:!!window.Worker,fileapi:window.File&&window.FileReader&&window.FileList&&window.Blob,getWebGLErrorMessage:function(){var a=document.createElement("div");return a.id="webgl-error-message",a.style.fontFamily="monospace",a.style.fontSize="13px",a.style.fontWeight="normal",a.style.textAlign="center",a.style.background="#fff",a.style.color="#000",a.style.padding="1.5em",a.style.width="400px",a.style.margin="5em auto 0",this.webgl||(a.innerHTML=window.WebGLRenderingContext?['Your graphics card does not seem to support <a href="http://khronos.org/webgl/wiki/Getting_a_WebGL_Implementation" style="color:#000">WebGL</a>.<br />','Find out how to get it <a href="http://get.webgl.org/" style="color:#000">here</a>.'].join("\n"):['Your browser does not seem to support <a href="http://khronos.org/webgl/wiki/Getting_a_WebGL_Implementation" style="color:#000">WebGL</a>.<br/>','Find out how to get it <a href="http://get.webgl.org/" style="color:#000">here</a>.'].join("\n")),a},addGetWebGLMessage:function(a){var b,c,d;a=a||{},b=void 0!==a.parent?a.parent:document.body,c=void 0!==a.id?a.id:"oldie",d=Detector.getWebGLErrorMessage(),d.id=c,b.appendChild(d)}};"object"==typeof module&&(module.exports=Detector);var _gsScope="undefined"!=typeof module&&module.exports&&"undefined"!=typeof global?global:this||window;(_gsScope._gsQueue||(_gsScope._gsQueue=[])).push(function(){"use strict";_gsScope._gsDefine("easing.Back",["easing.Ease"],function(a){var b,c,d,e=_gsScope.GreenSockGlobals||_gsScope,f=e.com.greensock,g=2*Math.PI,h=Math.PI/2,i=f._class,j=function(b,c){var d=i("easing."+b,function(){},!0),e=d.prototype=new a;return e.constructor=d,e.getRatio=c,d},k=a.register||function(){},l=function(a,b,c,d,e){var f=i("easing."+a,{easeOut:new b,easeIn:new c,easeInOut:new d},!0);return k(f,a),f},m=function(a,b,c){this.t=a,this.v=b,c&&(this.next=c,c.prev=this,this.c=c.v-b,this.gap=c.t-a)},n=function(b,c){var d=i("easing."+b,function(a){this._p1=a||0===a?a:1.70158,this._p2=1.525*this._p1},!0),e=d.prototype=new a;return e.constructor=d,e.getRatio=c,e.config=function(a){return new d(a)},d},o=l("Back",n("BackOut",function(a){return(a-=1)*a*((this._p1+1)*a+this._p1)+1}),n("BackIn",function(a){return a*a*((this._p1+1)*a-this._p1)}),n("BackInOut",function(a){return(a*=2)<1?.5*a*a*((this._p2+1)*a-this._p2):.5*((a-=2)*a*((this._p2+1)*a+this._p2)+2)})),p=i("easing.SlowMo",function(a,b,c){b=b||0===b?b:.7,null==a?a=.7:a>1&&(a=1),this._p=1!==a?b:0,this._p1=(1-a)/2,this._p2=a,this._p3=this._p1+this._p2,this._calcEnd=!0===c},!0),q=p.prototype=new a;return q.constructor=p,q.getRatio=function(a){var b=a+(.5-a)*this._p;return a<this._p1?this._calcEnd?1-(a=1-a/this._p1)*a:b-(a=1-a/this._p1)*a*a*a*b:a>this._p3?this._calcEnd?1-(a=(a-this._p3)/this._p1)*a:b+(a-b)*(a=(a-this._p3)/this._p1)*a*a*a:this._calcEnd?1:b},p.ease=new p(.7,.7),q.config=p.config=function(a,b,c){return new p(a,b,c)},b=i("easing.SteppedEase",function(a){a=a||1,this._p1=1/a,this._p2=a+1},!0),q=b.prototype=new a,q.constructor=b,q.getRatio=function(a){return 0>a?a=0:a>=1&&(a=.999999999),(this._p2*a>>0)*this._p1},q.config=b.config=function(a){return new b(a)},c=i("easing.RoughEase",function(b){b=b||{};for(var c,d,e,f,g,h,i=b.taper||"none",j=[],k=0,l=0|(b.points||20),n=l,o=!1!==b.randomize,p=!0===b.clamp,q=b.template instanceof a?b.template:null,r="number"==typeof b.strength?.4*b.strength:.4;--n>-1;)c=o?Math.random():1/l*n,d=q?q.getRatio(c):c,"none"===i?e=r:"out"===i?(f=1-c,e=f*f*r):"in"===i?e=c*c*r:.5>c?(f=2*c,e=f*f*.5*r):(f=2*(1-c),e=f*f*.5*r),o?d+=Math.random()*e-.5*e:n%2?d+=.5*e:d-=.5*e,p&&(d>1?d=1:0>d&&(d=0)),j[k++]={x:c,y:d};for(j.sort(function(a,b){return a.x-b.x}),h=new m(1,1,null),n=l;--n>-1;)g=j[n],h=new m(g.x,g.y,h);this._prev=new m(0,0,0!==h.t?h:h.next)},!0),q=c.prototype=new a,q.constructor=c,q.getRatio=function(a){var b=this._prev;if(a>b.t){for(;b.next&&a>=b.t;)b=b.next;b=b.prev}else for(;b.prev&&a<=b.t;)b=b.prev;return this._prev=b,b.v+(a-b.t)/b.gap*b.c},q.config=function(a){return new c(a)},c.ease=new c,l("Bounce",j("BounceOut",function(a){return 1/2.75>a?7.5625*a*a:2/2.75>a?7.5625*(a-=1.5/2.75)*a+.75:2.5/2.75>a?7.5625*(a-=2.25/2.75)*a+.9375:7.5625*(a-=2.625/2.75)*a+.984375}),j("BounceIn",function(a){return(a=1-a)<1/2.75?1-7.5625*a*a:2/2.75>a?1-(7.5625*(a-=1.5/2.75)*a+.75):2.5/2.75>a?1-(7.5625*(a-=2.25/2.75)*a+.9375):1-(7.5625*(a-=2.625/2.75)*a+.984375)}),j("BounceInOut",function(a){var b=.5>a;return a=b?1-2*a:2*a-1,a=1/2.75>a?7.5625*a*a:2/2.75>a?7.5625*(a-=1.5/2.75)*a+.75:2.5/2.75>a?7.5625*(a-=2.25/2.75)*a+.9375:7.5625*(a-=2.625/2.75)*a+.984375,b?.5*(1-a):.5*a+.5})),l("Circ",j("CircOut",function(a){return Math.sqrt(1-(a-=1)*a)}),j("CircIn",function(a){return-(Math.sqrt(1-a*a)-1)}),j("CircInOut",function(a){return(a*=2)<1?-.5*(Math.sqrt(1-a*a)-1):.5*(Math.sqrt(1-(a-=2)*a)+1)})),d=function(b,c,d){var e=i("easing."+b,function(a,b){this._p1=a>=1?a:1,this._p2=(b||d)/(1>a?a:1),this._p3=this._p2/g*(Math.asin(1/this._p1)||0),this._p2=g/this._p2},!0),f=e.prototype=new a;return f.constructor=e,f.getRatio=c,f.config=function(a,b){return new e(a,b)},e},l("Elastic",d("ElasticOut",function(a){return this._p1*Math.pow(2,-10*a)*Math.sin((a-this._p3)*this._p2)+1},.3),d("ElasticIn",function(a){return-this._p1*Math.pow(2,10*(a-=1))*Math.sin((a-this._p3)*this._p2)},.3),d("ElasticInOut",function(a){return(a*=2)<1?this._p1*Math.pow(2,10*(a-=1))*Math.sin((a-this._p3)*this._p2)*-.5:this._p1*Math.pow(2,-10*(a-=1))*Math.sin((a-this._p3)*this._p2)*.5+1},.45)),l("Expo",j("ExpoOut",function(a){return 1-Math.pow(2,-10*a)}),j("ExpoIn",function(a){return Math.pow(2,10*(a-1))-.001}),j("ExpoInOut",function(a){return(a*=2)<1?.5*Math.pow(2,10*(a-1)):.5*(2-Math.pow(2,-10*(a-1)))})),l("Sine",j("SineOut",function(a){return Math.sin(a*h)}),j("SineIn",function(a){return 1-Math.cos(a*h)}),j("SineInOut",function(a){return-.5*(Math.cos(Math.PI*a)-1)})),i("easing.EaseLookup",{find:function(b){return a.map[b]}},!0),k(e.SlowMo,"SlowMo","ease,"),k(c,"RoughEase","ease,"),k(b,"SteppedEase","ease,"),o},!0)}),_gsScope._gsDefine&&_gsScope._gsQueue.pop()(),function(){"use strict";var a=function(){return _gsScope.GreenSockGlobals||_gsScope};"function"==typeof define&&define.amd?define(["../TweenLite"],a):"undefined"!=typeof module&&module.exports&&(require("../TweenLite.js"),module.exports=a())}(),THREE.EffectComposer=function(a,b){if(this.renderer=a,void 0===b){var c=window.innerWidth||1,d=window.innerHeight||1,e={minFilter:THREE.LinearFilter,magFilter:THREE.LinearFilter,format:THREE.RGBFormat,stencilBuffer:!1};b=new THREE.WebGLRenderTarget(c,d,e)}this.renderTarget1=b,this.renderTarget2=b.clone(),this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2,this.passes=[],void 0===THREE.CopyShader&&console.error("THREE.EffectComposer relies on THREE.CopyShader"),this.copyPass=new THREE.ShaderPass(THREE.CopyShader)},THREE.EffectComposer.prototype={swapBuffers:function(){var a=this.readBuffer;this.readBuffer=this.writeBuffer,this.writeBuffer=a},addPass:function(a){this.passes.push(a)},insertPass:function(a,b){this.passes.splice(b,0,a)},render:function(a){this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2;var c,d,b=!1,e=this.passes.length;for(d=0;d<e;d++)if(c=this.passes[d],c.enabled){if(c.render(this.renderer,this.writeBuffer,this.readBuffer,a,b),c.needsSwap){if(b){var f=this.renderer.context;f.stencilFunc(f.NOTEQUAL,1,4294967295),this.copyPass.render(this.renderer,this.writeBuffer,this.readBuffer,a),f.stencilFunc(f.EQUAL,1,4294967295)}this.swapBuffers()}c instanceof THREE.MaskPass?b=!0:c instanceof THREE.ClearMaskPass&&(b=!1)}},reset:function(a){void 0===a&&(a=this.renderTarget1.clone(),a.width=window.innerWidth,a.height=window.innerHeight),this.renderTarget1=a,this.renderTarget2=a.clone(),this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2},setSize:function(a,b){var c=this.renderTarget1.clone();c.width=a,c.height=b,this.reset(c)}},THREE.EffectComposer.camera=new THREE.OrthographicCamera(-1,1,1,-1,0,1),THREE.EffectComposer.quad=new THREE.Mesh(new THREE.PlaneGeometry(2,2),null),THREE.EffectComposer.scene=new THREE.Scene,THREE.EffectComposer.scene.add(THREE.EffectComposer.quad),THREE.FilmShader={uniforms:{tDiffuse:{type:"t",value:null},time:{type:"f",value:0},nIntensity:{type:"f",value:.5},sIntensity:{type:"f",value:.05},sCount:{type:"f",value:4096},grayscale:{type:"i",value:1}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform float time;","uniform bool grayscale;","uniform float nIntensity;","uniform float sIntensity;","uniform float sCount;","uniform sampler2D tDiffuse;","varying vec2 vUv;","float rand(vec2 co){","return fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);","}","void main() {","vec4 cTextureScreen = texture2D( tDiffuse, vUv );","vec3 cResult = cTextureScreen.rgb;","vec2 sc = vec2( sin( vUv.y * sCount ), cos( vUv.y * sCount ) );","cResult += cTextureScreen.rgb * vec3( sc.x, sc.y, sc.x ) * sIntensity;","cResult = cTextureScreen.rgb + clamp( nIntensity, 0.0,1.0 ) * ( cResult - cTextureScreen.rgb );","gl_FragColor =  vec4( cResult, cTextureScreen.a );","}"].join("\n")};var ImprovedNoise=function(){function c(a){return a*a*a*(a*(6*a-15)+10)}function d(a,b,c){return b+a*(c-b)}function e(a,b,c,d){var e=15&a,f=e<8?b:c,g=e<4?c:12==e||14==e?b:d;return(0==(1&e)?f:-f)+(0==(2&e)?g:-g)}for(var a=[151,160,137,91,90,15,131,13,201,95,96,53,194,233,7,225,140,36,103,30,69,142,8,99,37,240,21,10,23,190,6,148,247,120,234,75,0,26,197,62,94,252,219,203,117,35,11,32,57,177,33,88,237,149,56,87,174,20,125,136,171,168,68,175,74,165,71,134,139,48,27,166,77,146,158,231,83,111,229,122,60,211,133,230,220,105,92,41,55,46,245,40,244,102,143,54,65,25,63,161,1,216,80,73,209,76,132,187,208,89,18,169,200,196,135,130,116,188,159,86,164,100,109,198,173,186,3,64,52,217,226,250,124,123,5,202,38,147,118,126,255,82,85,212,207,206,59,227,47,16,58,17,182,189,28,42,223,183,170,213,119,248,152,2,44,154,163,70,221,153,101,155,167,43,172,9,129,22,39,253,19,98,108,110,79,113,224,232,178,185,112,104,218,246,97,228,251,34,242,193,238,210,144,12,191,179,162,241,81,51,145,235,249,14,239,107,49,192,214,31,181,199,106,157,184,84,204,176,115,121,50,45,127,4,150,254,138,236,205,93,222,114,67,29,24,72,243,141,128,195,78,66,215,61,156,180],b=0;b<256;b++)a[256+b]=a[b];return{noise:function(b,f,g){var h=~~b,i=~~f,j=~~g,k=255&h,l=255&i,m=255&j;b-=h,f-=i,g-=j;var n=b-1,o=f-1,p=g-1,q=c(b),r=c(f),s=c(g),t=a[k]+l,u=a[t]+m,v=a[t+1]+m,w=a[k+1]+l,x=a[w]+m,y=a[w+1]+m;return d(s,d(r,d(q,e(a[u],b,f,g),e(a[x],n,f,g)),d(q,e(a[v],b,o,g),e(a[y],n,o,g))),d(r,d(q,e(a[u+1],b,f,p),e(a[x+1],n,f,g-1)),d(q,e(a[v+1],b,o,p),e(a[y+1],n,o,p))))}}};THREE.MaskPass=function(a,b){this.scene=a,this.camera=b,this.enabled=!0,this.clear=!0,this.needsSwap=!1,this.inverse=!1},THREE.MaskPass.prototype={render:function(a,b,c,d){var e=a.context;e.colorMask(!1,!1,!1,!1),e.depthMask(!1);var f,g;this.inverse?(f=0,g=1):(f=1,g=0),e.enable(e.STENCIL_TEST),e.stencilOp(e.REPLACE,e.REPLACE,e.REPLACE),e.stencilFunc(e.ALWAYS,f,4294967295),e.clearStencil(g),a.render(this.scene,this.camera,c,this.clear),a.render(this.scene,this.camera,b,this.clear),e.colorMask(!0,!0,!0,!0),e.depthMask(!0),e.stencilFunc(e.EQUAL,1,4294967295),e.stencilOp(e.KEEP,e.KEEP,e.KEEP)}},THREE.ClearMaskPass=function(){this.enabled=!0},THREE.ClearMaskPass.prototype={render:function(a,b,c,d){var e=a.context;e.disable(e.STENCIL_TEST)}},THREE.RenderPass=function(a,b,c,d,e){this.scene=a,this.camera=b,this.overrideMaterial=c,this.clearColor=d,this.clearAlpha=void 0!==e?e:1,this.oldClearColor=new THREE.Color,this.oldClearAlpha=1,this.enabled=!0,this.clear=!0,this.needsSwap=!1},THREE.RenderPass.prototype={render:function(a,b,c,d){this.scene.overrideMaterial=this.overrideMaterial,this.clearColor&&(this.oldClearColor.copy(a.getClearColor()),this.oldClearAlpha=a.getClearAlpha(),a.setClearColor(this.clearColor,this.clearAlpha)),a.render(this.scene,this.camera,c,this.clear),this.clearColor&&a.setClearColor(this.oldClearColor,this.oldClearAlpha),this.scene.overrideMaterial=null}},THREE.RGBShiftShader={uniforms:{tDiffuse:{type:"t",value:null},amount:{type:"f",value:.005},angle:{type:"f",value:0}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D tDiffuse;","uniform float amount;","uniform float angle;","varying vec2 vUv;","void main() {","vec2 offset = amount * vec2( cos(angle), sin(angle));","vec4 cr = texture2D(tDiffuse, vUv + offset);","vec4 cga = texture2D(tDiffuse, vUv);","vec4 cb = texture2D(tDiffuse, vUv - offset);","gl_FragColor = vec4(cr.r, cga.g, cb.b, cga.a);","}"].join("\n")},THREE.ShaderPass=function(a,b){this.textureID=void 0!==b?b:"tDiffuse",this.uniforms=THREE.UniformsUtils.clone(a.uniforms),this.material=new THREE.ShaderMaterial({uniforms:this.uniforms,vertexShader:a.vertexShader,fragmentShader:a.fragmentShader}),this.renderToScreen=!1,this.enabled=!0,this.needsSwap=!0,this.clear=!1},THREE.ShaderPass.prototype={render:function(a,b,c,d){this.uniforms[this.textureID]&&(this.uniforms[this.textureID].value=c),THREE.EffectComposer.quad.material=this.material,this.renderToScreen?a.render(THREE.EffectComposer.scene,THREE.EffectComposer.camera):a.render(THREE.EffectComposer.scene,THREE.EffectComposer.camera,b,this.clear)}},THREE.StaticShader={uniforms:{tDiffuse:{type:"t",value:null},time:{type:"f",value:0},amount:{type:"f",value:.5},size:{type:"f",value:4}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D tDiffuse;","uniform float time;","uniform float amount;","uniform float size;","varying vec2 vUv;","float rand(vec2 co){","return fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);","}","void main() {","vec2 p = vUv;","vec4 color = texture2D(tDiffuse, p);","float xs = floor(gl_FragCoord.x / size);","float ys = floor(gl_FragCoord.y / size);","vec4 snow = vec4(rand(vec2(xs * time,ys * time))*amount);","gl_FragColor = color+ snow;","}"].join("\n")};var Stats=function(){function a(a){return d.appendChild(a.dom),a}function b(a){for(var b=0;b<d.children.length;b++)d.children[b].style.display=b===a?"block":"none";c=a}var c=0,d=document.createElement("div");d.style.cssText="position:fixed;top:0;left:0;cursor:pointer;opacity:0.9;z-index:10000",d.addEventListener("click",function(a){a.preventDefault(),b(++c%d.children.length)},!1);var e=(performance||Date).now(),f=e,g=0,h=a(new Stats.Panel("FPS","#0ff","#002")),i=a(new Stats.Panel("MS","#0f0","#020"));if(self.performance&&self.performance.memory)var j=a(new Stats.Panel("MB","#f08","#201"));return b(0),{REVISION:16,dom:d,addPanel:a,showPanel:b,begin:function(){e=(performance||Date).now()},end:function(){g++;var a=(performance||Date).now();if(i.update(a-e,200),a>f+1e3&&(h.update(1e3*g/(a-f),100),f=a,g=0,j)){var b=performance.memory;j.update(b.usedJSHeapSize/1048576,b.jsHeapSizeLimit/1048576)}return a},update:function(){e=this.end()},domElement:d,setMode:b}};Stats.Panel=function(a,b,c){var d=1/0,e=0,f=Math.round,g=f(window.devicePixelRatio||1),h=80*g,i=48*g,j=3*g,k=2*g,l=3*g,m=15*g,n=74*g,o=30*g,p=document.createElement("canvas");p.width=h,p.height=i,p.style.cssText="width:80px;height:48px";var q=p.getContext("2d");return q.font="bold "+9*g+"px Helvetica,Arial,sans-serif",q.textBaseline="top",q.fillStyle=c,q.fillRect(0,0,h,i),q.fillStyle=b,q.fillText(a,j,k),q.fillRect(l,m,n,o),q.fillStyle=c,q.globalAlpha=.9,q.fillRect(l,m,n,o),{dom:p,update:function(i,r){d=Math.min(d,i),e=Math.max(e,i),q.fillStyle=c,q.globalAlpha=1,q.fillRect(0,0,h,m),q.fillStyle=b,q.fillText(f(i)+" "+a+" ("+f(d)+"-"+f(e)+")",j,k),q.drawImage(p,l+g,m,n-g,o,l,m,n-g,o),q.fillRect(l+n-g,m,g,o),q.fillStyle=c,q.globalAlpha=.9,q.fillRect(l+n-g,m,g,f((1-i/r)*o))}}},"object"==typeof module&&(module.exports=Stats);